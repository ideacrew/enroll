## Step-by-Step Dry Run Guide: Setting Up for a New Year's Operations

### **Step 1: Validate Environment Readiness**

Ensure the environment is ready for the new year's operations:

- Update the dependent filing threshold environment variable for the specified year.
- Optionally, update the affordability percentage variable.
- Check and update the components of the SLCSP (Second Lowest Cost Silver Plan) generator (within rake task `dry_run:data:create_benefit_market_catalogs`).

### **Step 2: Clear Existing Data (optional)**

Remove existing data associated with the given year (generated by a prior dry run):

- Service Areas (`::BenefitMarkets::Locations::ServiceArea`).
- Rating Areas (`::BenefitMarkets::Locations::RatingArea`).
- Actuarial Factors (Rate) Factors:
  - Participation Rate Actuarial Factors (`::BenefitMarkets::Products::ActuarialFactors::ParticipationRateActuarialFactor`).
  - Group Size Actuarial Factors (`::BenefitMarkets::Products::ActuarialFactors::GroupSizeActuarialFactor`).
- Plans (`::Plan`).
- Products (`::BenefitMarkets::Products::Product`).
- Benefit Coverage Period (`HbxProfile.current_hbx.benefit_sponsorship.benefit_coverage_periods`).
- Benefit Packages (`::BenefitSponsors::BenefitPackages::BenefitPackage`).
- Benefit Market Catalogs (`BenefitMarkets::BenefitMarketCatalog`).
- Financial Assistance Applications (`::FinancialAssistance::Application`).

### **Step 3: Populate New Data**

Generate fresh data for the upcoming year:

- Service Areas (`::BenefitMarkets::Locations::ServiceArea`).
- Rating Areas (`::BenefitMarkets::Locations::RatingArea`).
- Actuarial Factors (Rate) Factors:
  - Participation Rate Actuarial Factors (`::BenefitMarkets::Products::ActuarialFactors::ParticipationRateActuarialFactor`).
  - Group Size Actuarial Factors (`::BenefitMarkets::Products::ActuarialFactors::GroupSizeActuarialFactor`).
- Plans (`::Plan`).
- Products (`::BenefitMarkets::Products::Product`).
- Benefit Coverage Period (`HbxProfile.current_hbx.benefit_sponsorship.benefit_coverage_periods`).
- Benefit Packages (`::BenefitSponsors::BenefitPackages::BenefitPackage`).
- Benefit Market Catalogs (`BenefitMarkets::BenefitMarketCatalog`).
- Map Products and Plans from the previous year to the current year:
  - Attach previous year's `sbc_documents` as the current year's `sbc_documents`.
  - Link previous year's Plans' `renewal_plan_id` to the current year's Plan `hios_id`.
  - Link previous year's Products' `renewal_product_id` to the current year's Product `hios_id`.

### **Step 4: Manage Open Enrollment Period**

Control the open enrollment period for the given year:

- Close the open enrollment period for the previous year.
- Initiate the open enrollment period for the upcoming year.

### **Step 5: Execute Renewal Process**

Perform the renewal process using the provided command:

- Run `FinancialAssistance::Operations::Applications::AptcCsrCreditEligibilities::Renewals::RequestAll.new.call({ renewal_year: year })`.

### **Step 6: Run Determination Process**

Execute the determination process using the provided command:

- Run `FinancialAssistance::Operations::Applications::AptcCsrCreditEligibilities::Renewals::DetermineAll.new.call({ renewal_year: year })`.

### **Step 7: Trigger Notices**

Activate the notice triggers as follows:

- Call `Operations::Notices::IvlOeReverificationTrigger.new.call(family: family)` for families meeting specific criteria:
  - Enrolled in the current year without financial assistance.
  - Enrolled with financial assistance but awaiting determination (approval).

### **Step 8: Generate Renewal Report**

Produce the following renewal reports:

1. **Families Eligible for Financial Assistance Renewal:**
  - Identify families enrolled in the current year with financial assistance and their expected status in the new application.

2. **Families with Financial Assistance Renewal:**
  - Identify families enrolled in the current year with financial assistance and having a new application for the new year.
  - Include the status of each new application along with any associated errors.

3. **Families without Financial Assistance Renewal:**
  - Identify families enrolled in the current year with financial assistance but lacking a new application for the new year.
  - Include any errors.

4. **Consolidated Discrepancy Report:**
  - Present an overview of all the sections, highlighting any differences between expected and actual outcomes.

### **Step 9: Generate Notice Report**

Create the notice report containing:

1. **Expected Notices for the Given Year:**
2. **Actual Notices Triggered for the Given Year:**
3. **Consolidated Discrepancy Report:**
