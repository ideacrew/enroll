<%if @errors && @errors.any? %>
  <div class='alert alert-error'><a class='close' data-dismiss='alert'>x</a>
    <%@errors.each do |msg|%>
      <li><%= msg %></li>
    <%end%>
  </div>
<%end%>

<h3 class="text-center">Edit User Credentials</h3>
<div id="credentials-matches" class="hidden">
  <h4 class="text-center">User Account Update Failed</h4>
  <div id="credentials-error-message"></div>
  <h5>Please resolve the match issue.</h5>
</div>
<br/>
<%= form_tag(user_account_confirm_change_username_and_email_path(user_id: @user_id, account_id: @account_id), method: :put, id: "changeUsernameEmailForm", class:"form-horizontal", remote: true) do %>
  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
  <%= hidden_field_tag :current_username, @username %>
  <%= hidden_field_tag :current_email, @email %>

  <div class="field-error-block alert-danger hidden" style="margin-bottom:20px;">
  </div>
  <div class="row" style="padding-left: 150px;">
    <div class="form-group col-sm-4">
      <label for="inputNewUsername" class="col-form-label">New Username</label>
      <%= text_field_tag :new_username, @username, {class:"form-control", id:'inputNewUsername'} %>
    </div>
    <div class="form-group col-sm-4">
      <label for="inputNewEmail" class="col-form-label">New Email</label>
      <%= text_field_tag :new_email, @email, {class:"form-control", id:'inputNewEmail'} %>
      <%= hidden_field :family_actions_id, :value => "family_actions_#{@user.id.to_s}" %>
      <span class="help-block email-block hidden"></span>
    </div>
    <div class="form-group col-sm-4">
      <label for="inputPermission" class="col-form-label">HBX Staff Role</label>
      <%= select_tag :permission_id, permission_options(current_user.person.hbx_staff_role.permission, @user.person&.hbx_staff_role&.permission), include_blank: 'None' %>
    </div>
  </div>
  <br />
  <br />
  <div class="row" style="padding-left: 150px;">
    <div class="col-sm-1 col-sm-offset-4">
      <%= button_tag "Reset", class:'btn btn-info', id: 'resetUsernameEmailFields' %>
    </div>
    <div class="col-sm-1">
      <%= submit_tag "Submit", class:'btn btn-primary', data: {confirm: "Are you sure?"} %>
    </div>
  </div>
<% end %>

<script type="text/javascript" charset="utf-8">
    $(document).ready(function(){
        var resetButton = document.getElementById('resetUsernameEmailFields');
        resetButton.addEventListener('click', function(event){
            event.preventDefault();
            document.getElementById('inputNewUsername').value="";
            document.getElementById('inputNewEmail').value="";
        });
    });
</script>
