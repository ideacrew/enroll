<!DOCTYPE HTML SYSTEM>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Brakeman Report</title>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript">
    function toggle(context) {
      var elem = document.getElementById(context);

      if (elem.style.display != "block")
        elem.style.display = "block";
      else
        elem.style.display = "none";

      elem.parentNode.scrollIntoView();
    }

    $(document).ready(function() {
      $('table').DataTable({
        searching: false,
        paging:    false,
        info:      false
      });
    });
  </script>
  <style>
    /* CSS style used for HTML reports */

body {
  font-family: sans-serif;
  color: #161616;
}

a {
  color: #161616;
}

p {
  font-weight: bold;
  font-size: 11pt;
  color: #2D0200;
 }

 th {
   background-color: #980905;
   border-bottom: 5px solid #530200;
   color: white;
   font-size: 11pt;
   padding: 1px 8px 1px 8px;
 }

 td {
   border-bottom: 2px solid white;
   font-family: monospace;
   padding: 5px 8px 1px 8px;
 }

 table {
   background-color: #FCF4D4;
   border-collapse: collapse;
 }

 h1 {
   color: #2D0200;
   font-size: 14pt;
 }

 h2 {
   color: #2D0200;
   font-size: 12pt;
 }

 span.high-confidence {
   font-weight:bold;
   color: red;
 }

 span.med-confidence {
 }

 span.weak-confidence {
   color:gray;
 }

 div.warning_message {
   cursor: pointer;
 }

 div.warning_message:hover {
   background-color: white;
 }

 table caption {
   background-color: #FFE;
   padding: 2px;
 }

 table.context {
   margin-top: 5px;
   margin-bottom: 5px;
   border-left: 1px solid #90e960;
   color: #212121;
 }

 tr.context {
   background-color: white;
 }

 tr.first {
   border-top: 1px solid #7ecc54;
   padding-top: 2px;
 }

 tr.error {
  background-color: #f4c1c1 !important
 }

 tr.near_error {
  background-color: #f4d4d4 !important
 }

 tr.alt {
   background-color: #e8f4d4;
 }

 td.context {
   padding: 2px 10px 0px 6px;
   border-bottom: none;
 }

 td.context_line {
   padding: 2px 8px 0px 7px;
   border-right: 1px solid #b3bda4;
   border-bottom: none;
   color: #6e7465;
 }

 pre.context {
   margin-bottom: 1px;
 }

 .user_input {
   background-color: #fcecab;
 }

 div.render_path {
   display: none;
   background-color: #ffe;
   padding: 5px;
   margin: 2px 0px 2px 0px;
 }

 div.template_name {
   cursor: pointer;
 }

 div.template_name:hover {
   background-color: white;
 }

 span.code {
   font-family: monospace;
 }

 span.filename {
   font-family: monospace;
 }

  </style>
</head>
<body>

<h1>Brakeman Report</h1>
<table>
  <thead>
    <tr>
      <th>Application Path</th>
      <th>Rails Version</th>
      <th>Brakeman Version</th>
      <th>Report Time</th>
      <th>Checks Performed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>/Users/alecturnbull/Projects/enroll</td>
      <td>5.2.4.4</td>
      <td>5.4.1
      <td>
        2024-02-26 15:28:34 -0600<br><br>
        30.1415 seconds
      </td>
      <td>BasicAuth, BasicAuthTimingAttack, CSRFTokenForgeryCVE, ContentTag, CookieSerialization, CreateWith, CrossSiteScripting, DefaultRoutes, Deserialize, DetailedExceptions, DigestDoS, DynamicFinders, EOLRails, EOLRuby, EscapeFunction, Evaluation, Execute, FileAccess, FileDisclosure, FilterSkipping, ForgerySetting, HeaderDoS, HtmlSafeUsage, I18nXSS, JRubyXML, JSONEncoding, JSONEntityEscape, JSONParsing, LinkTo, LinkToHref, MailTo, MassAssignment, MimeTypeDoS, ModelAttrAccessible, ModelAttributes, ModelSerialize, NestedAttributes, NestedAttributesBypass, NumberToCurrency, PageCachingCVE, Pathname, PermitAttributes, QuoteTableName, Redirect, RegexDoS, Render, RenderDoS, RenderInline, ResponseSplitting, RouteDoS, SQL, SQLCVEs, SSLVerify, SafeBufferManipulation, SanitizeConfigCve, SanitizeMethods, SelectTag, SelectVulnerability, Send, SendFile, SessionManipulation, SessionSettings, SimpleFormat, SingleQuotes, SkipBeforeFilter, SprocketsPathTraversal, StripTags, SymbolDoSCVE, TemplateInjection, TranslateBug, UnsafeReflection, UnsafeReflectionMethods, ValidationRegex, VerbConfusion, WeakRSAKey, WithoutProtection, XMLDoS, YAMLParsing</td>
    </tr>
  </tbody>
</table>
<br>
<h2 id='summary'>Summary</h2>
<table>
  <thead>
    <tr>
      <th>Scanned/Reported</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Controllers</td>
      <td>135</td>
    </tr>
    <tr>
      <td>Models</td>
      <td>1088</td>
    </tr>
    <tr>
      <td>Templates</td>
      <td>1664</td>
    </tr>
    <tr>
      <td>Errors</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Security Warnings</td>
      <td>0 <span class='high-confidence'>(0)</span></td>
    </tr>
  
    <tr>
      <td>Ignored Warnings</td>
      <td>94</td>
    </tr>
  
  </tbody>
</table>
<br>
<div onClick="toggle('ignored_table');">  <h2>94 Ignored Warnings (click to see them)</h2 ></div>
<div>
  <table style="display:none" id="ignored_table">
    <thead>
      <tr>
        <th>Confidence</th>
        <th>File</th>
        <th>Warning Type</th>
        <th>CWE ID</th>
        <th>Message</th>
        <th>Note</th>
      </tr>
    </thead>
    <tbody>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>app/data_migrations/force_publish_ben_app_reports.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context10');toggle('message10');toggle('full_message10')" >Possible command injection near line 64: <span class="code">system(&quot;rm -rf #{&quot;#{Rails.root}/unnassigned_packages_#{<span class="user_input">TimeKeeper.date_of_record.strftime(&quot;%Y_%m_%d&quot;)</span>}.csv&quot;}&quot;)</span><table id='context10' class='context' style='display:none'><caption>app/data_migrations/force_publish_ben_app_reports.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>59</pre>
          </td>
          <td class='context'>
            <pre class='context'>    puts &quot;----renewing draft count == #{benefit_applications_in_aasm_state([&#39;draft&#39;], start_on_date).count} after reverting plan years&quot; unless Rails.env.test?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def assign_packages(start_on_date, _current_date)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    file_name = &quot;#{Rails.root}/unnassigned_packages_#{TimeKeeper.date_of_record.strftime(&#39;%Y_%m_%d&#39;)}.csv&quot;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>    system(&quot;rm -rf #{file_name}&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>    CSV.open(file_name, &quot;w&quot;) do |csv|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>      csv &lt;&lt; [&quot;Sponsor fein&quot;, &quot;Sponsor legal_name&quot;, &quot;Census_Employee&quot;, &quot;ce id&quot;]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>      BenefitSponsors::BenefitSponsorships::BenefitSponsorship.where(:&#39;benefit_applications.effective_period.min&#39; =&gt; start_on_date).each do |ben_spon|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>        ben_spon.benefit_applications.each do |bene_app|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>          next unless bene_app.effective_period.min == start_on_date &amp;&amp; bene_app.is_renewing?</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>app/data_migrations/force_publish_ben_app_reports.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context11');toggle('message11');toggle('full_message11')" >Possible command injection near line 184: <span class="code">system(&quot;rm -rf #{&quot;#{Rails.root}/dry_run_dc_nfp_non_detailed_report_#{<span class="user_input">TimeKeeper.date_of_record.strftime(&quot;%Y_%m_%d&quot;)</span>}.csv&quot;}&quot;)</span><table id='context11' class='context' style='display:none'><caption>app/data_migrations/force_publish_ben_app_reports.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>179</pre>
          </td>
          <td class='context'>
            <pre class='context'>      &quot;Employer_FEIN&quot;,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>180</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &quot;Renewal State&quot;,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>181</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &quot;#{start_on_date.prev_year.year} Active Enrollments&quot;,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>182</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &quot;#{start_on_date.prev_year.year} Passive Renewal Enrollments&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ]</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>184</pre>
            </td>
            <td class='context'>
              <pre class='context'>    system(&quot;rm -rf #{file_name}&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>    CSV.open(file_name, &quot;w&quot;, force_quotes: true) do |csv|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>187</pre>
            </td>
            <td class='context'>
              <pre class='context'>      csv &lt;&lt; field_names</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>      BenefitSponsors::BenefitSponsorships::BenefitSponsorship.where(:&#39;benefit_applications.effective_period.min&#39; =&gt; start_on_date).each do |ben_spon|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>189</pre>
            </td>
            <td class='context'>
              <pre class='context'>        ben_spon.benefit_applications.each do |ben_app|</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>app/data_migrations/force_publish_ben_app_reports.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context12');toggle('message12');toggle('full_message12')" >Possible command injection near line 237: <span class="code">system(&quot;rm -rf #{&quot;#{Rails.root}/dry_run_dc_nfp_detailed_report_#{<span class="user_input">TimeKeeper.date_of_record.strftime(&quot;%Y_%m_%d&quot;)</span>}.csv&quot;}&quot;)</span><table id='context12' class='context' style='display:none'><caption>app/data_migrations/force_publish_ben_app_reports.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>232</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>234</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def detailed_report(start_on_date, _current_date)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>235</pre>
            </td>
            <td class='context'>
              <pre class='context'>    file_name = &quot;#{Rails.root}/dry_run_dc_nfp_detailed_report_#{TimeKeeper.date_of_record.strftime(&#39;%Y_%m_%d&#39;)}.csv&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>237</pre>
            </td>
            <td class='context'>
              <pre class='context'>    system(&quot;rm -rf #{file_name}&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>239</pre>
            </td>
            <td class='context'>
              <pre class='context'>    CSV.open(file_name, &quot;w&quot;, force_quotes: true) do |csv|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>240</pre>
            </td>
            <td class='context'>
              <pre class='context'>      csv &lt;&lt; detailed_report_field_names(start_on_date)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>241</pre>
            </td>
            <td class='context'>
              <pre class='context'>      BenefitSponsors::BenefitSponsorships::BenefitSponsorship.where(:&#39;benefit_applications.effective_period.min&#39; =&gt; start_on_date).no_timeout.each do |ben_spon|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>242</pre>
            </td>
            <td class='context'>
              <pre class='context'>        ben_spon.benefit_applications.each do |ben_app|</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>app/views/layouts/_flash.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
        <td>[79]</td>
        <td><div class='warning_message' onClick="toggle('context43');toggle('message43');toggle('full_message43')" >Unescaped model attribute near line 6: <span class="code">ScheduledEvent.new(scheduled_event_params).errors.values.flatten.to_sentence</span><table id='context43' class='context' style='display:none'><caption>app/views/layouts/_flash.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;row flash module&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;div class=&quot;alert alert-&lt;%= type %&gt;&quot; style=&quot;width: 100%; margin-top: 0px !important;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;div class=&quot;row&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;div class=&quot;col-xs-12&quot; style=&quot;width: 100%; max-width: 1170px; margin: auto;&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;a class=&quot;close&quot; data-dismiss=&quot;alert&quot; href=&quot;#&quot;&gt;×&lt;/a&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;%= raw message %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>components/financial_assistance/app/controllers/financial_assistance/evidences_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/dangerous_send/">Dangerous Send</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context20');toggle('message20');toggle('full_message20')" >User controlled method execution near line 76: <span class="code">@docs_owner.send(<span class="user_input">params[:evidence_kind]</span>)</span><table id='context20' class='context' style='display:none'><caption>components/financial_assistance/app/controllers/financial_assistance/evidences_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>71</pre>
          </td>
          <td class='context'>
            <pre class='context'>    end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def find_type</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>      fetch_applicant</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>      find_docs_owner</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>76</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @evidence = @docs_owner.send(params[:evidence_kind]) if @docs_owner.respond_to?(params[:evidence_kind])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def update_documents_status(applicant)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>      family = applicant.family</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>      family.update_family_document_status!</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>components/financial_assistance/app/controllers/financial_assistance/verification_documents_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/dangerous_send/">Dangerous Send</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context21');toggle('message21');toggle('full_message21')" >User controlled method execution near line 122: <span class="code">@docs_owner.send(<span class="user_input">params[:evidence_kind]</span>)</span><table id='context21' class='context' style='display:none'><caption>components/financial_assistance/app/controllers/financial_assistance/verification_documents_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>117</pre>
          </td>
          <td class='context'>
            <pre class='context'>    end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def find_type</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>120</pre>
            </td>
            <td class='context'>
              <pre class='context'>      fetch_applicant</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>121</pre>
            </td>
            <td class='context'>
              <pre class='context'>      find_docs_owner</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>122</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @evidence = @docs_owner.send(params[:evidence_kind]) if @docs_owner.respond_to?(params[:evidence_kind])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def file_path(file)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>      file.tempfile.path</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>app/controllers/documents_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
        <td>[470]</td>
        <td><div class='warning_message' onClick="toggle('context29');toggle('message29');toggle('full_message29')" >Unsafe reflection method <span class="code">safe_constantize</span> called on parameter value near line 37: <span class="code">(<span class="user_input">params[:model].camelize</span> or &quot;BenefitSponsors::Organizations::AcaShopCcaEmployerProfile&quot;).safe_constantize</span><table id='context29' class='context' style='display:none'><caption>app/controllers/documents_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>33</pre>
          </td>
          <td class='context'>
            <pre class='context'>      #this is a fix for new model inbox-messages notice download</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if model == &quot;AcaShopCcaEmployerProfile&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>        model = &quot;BenefitSponsors::Organizations::AcaShopCcaEmployerProfile&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>      model_klass = Document::RESOURCE_LIST.include?(model) ? model.safe_constantize : nil</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise &quot;Sorry! Invalid Request&quot; unless model_klass</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>      model_object = model_klass.find(model_id)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>      documents = model_object.send(relation.to_sym)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if authorized_to_download?(model_object, documents, relation_id)</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>Gemfile.lock</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/unmaintained_dependency/">Unmaintained Dependency</a></td>
        <td>[1104]</td>
        <td><div class='warning_message' onClick="toggle('context1');toggle('message1');toggle('full_message1')" >Support for Rails 5.2.4.4 ended on 2022-06-01 near line 723<table id='context1' class='context' style='display:none'><caption>Gemfile.lock</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>718</pre>
          </td>
          <td class='context'>
            <pre class='context'>    rack-proxy (0.6.5)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>719</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rack</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>720</pre>
            </td>
            <td class='context'>
              <pre class='context'>    rack-test (1.1.0)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>721</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rack (&gt;= 1.0, &lt; 3)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>722</pre>
            </td>
            <td class='context'>
              <pre class='context'>    railroady (1.5.3)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>723</pre>
            </td>
            <td class='context'>
              <pre class='context'>    rails (5.2.4.4)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>724</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actioncable (= 5.2.4.4)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>725</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actionmailer (= 5.2.4.4)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>726</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actionpack (= 5.2.4.4)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>727</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actionview (= 5.2.4.4)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>728</pre>
            </td>
            <td class='context'>
              <pre class='context'>      activejob (= 5.2.4.4)</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Planned to be delt with by rails upgrade.</td>
      </tr>
    
      <tr>
        <td><span class='high-confidence'>High</span></td>
        <td>.ruby-version</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/unmaintained_dependency/">Unmaintained Dependency</a></td>
        <td>[1104]</td>
        <td><div class='warning_message' onClick="toggle('context2');toggle('message2');toggle('full_message2')" >Support for Ruby 2.6.3 ended on 2022-03-31 near line 1<table id='context2' class='context' style='display:none'><caption>.ruby-version</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>2.6.3</pre>
          </td>
        </tr>
</tbody></table></div></td>
        <td>Planned to be delt with by ruby upgrade.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/client_configuration_toggler.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context3');toggle('message3');toggle('full_message3')" >Possible command injection near line 35: <span class="code">`cp -r #{<span class="user_input">target_config_folder</span>}/system #{Rails.root}`</span><table id='context3' class='context' style='display:none'><caption>lib/client_configuration_toggler.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>31</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def copy_target_configuration_to_system_folder</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    target_configuration_files = Dir.glob(&quot;#{target_config_folder}/system/**/*.yml&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>    raise(&quot;No configuration files present in target directory.&quot;) if target_configuration_files.blank?</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>    `rm -rf #{Rails.root}/system` if Dir.exist?(&quot;#{Rails.root}/system&quot;)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>    `cp -r #{target_config_folder}/system #{Rails.root}`</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if File.exist?(&quot;#{target_config_folder}/config/settings.yml&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>      puts(&quot;Settings.yml present for target configuration, setting it as current settings.&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>      puts(&quot;No settings.yml file present for target configuration&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/client_configuration_toggler.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context4');toggle('message4');toggle('full_message4')" >Possible command injection near line 41: <span class="code">`cp -r #{<span class="user_input">target_config_folder</span>}/config/settings.yml config/settings.yml`</span><table id='context4' class='context' style='display:none'><caption>lib/client_configuration_toggler.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>36</pre>
          </td>
          <td class='context'>
            <pre class='context'>    if File.exist?(&quot;#{target_config_folder}/config/settings.yml&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>      puts(&quot;Settings.yml present for target configuration, setting it as current settings.&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>      puts(&quot;No settings.yml file present for target configuration&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>    `cp -r #{target_config_folder}/config/settings.yml config/settings.yml`</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def copy_app_assets_and_straggler_files</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # Need to make this only return files</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>    target_configuration_files = Dir.glob(&quot;#{target_config_folder}/**/*&quot;).select { |e| File.file? e }</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/client_configuration_toggler.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context5');toggle('message5');toggle('full_message5')" >Possible command injection near line 51: <span class="code">`cp -r #{<span class="user_input">filename_in_config_directory</span>} #{<span class="user_input">filename_in_config_directory</span>.sub(&quot;#{target_config_folder}/&quot;, &quot;&quot;)}`</span><table id='context5' class='context' style='display:none'><caption>lib/client_configuration_toggler.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>46</pre>
          </td>
          <td class='context'>
            <pre class='context'>    target_configuration_files = Dir.glob(&quot;#{target_config_folder}/**/*&quot;).select { |e| File.file? e }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    target_configuration_files.reject { |file| file.include?(&#39;system&#39;) || file.include?(&#39;settings&#39;) }.each do |filename_in_config_directory|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # Cut off the filename parts with config namespace</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>      puts(&quot;Swapping app assets and other straggler files.&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>      actual_filename_in_enroll = filename_in_config_directory.sub(&quot;#{target_config_folder}/&quot;, &#39;&#39;)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>      `cp -r #{filename_in_config_directory} #{actual_filename_in_enroll}`</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def checkout_straggler_files</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>    straggler_files = Dir.glob(&quot;#{old_config_folder}/**/*&quot;).select { |e| File.file? e }</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/client_configuration_toggler.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context6');toggle('message6');toggle('full_message6')" >Possible command injection near line 62: <span class="code">`git checkout #{<span class="user_input">filename_in_config_directory.sub(&quot;#{old_config_folder}/&quot;, &quot;&quot;)</span>}`</span><table id='context6' class='context' style='display:none'><caption>lib/client_configuration_toggler.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>57</pre>
          </td>
          <td class='context'>
            <pre class='context'>    # TODO: Deprecate settings and move this eventually</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    straggler_files.reject { |file| file.include?(&#39;system&#39;) || file.include?(&#39;settings&#39;) }.each do |filename_in_config_directory|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # Cut off the filename parts with config namespace</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>      puts(&quot;Checking out old config app assets and other straggler files.&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      filename_without_root = filename_in_config_directory.sub(&quot;#{old_config_folder}/&quot;, &#39;&#39;)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      `git checkout #{filename_without_root}`</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def migrate</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @old_configured_state_abbreviation = old_configured_state_abbreviation</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/custom_linters/translations/view_translations_linter_helper.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context7');toggle('message7');toggle('full_message7')" >Possible command injection near line 89: <span class="code">`git diff HEAD^ HEAD  --unified=0 #{<span class="user_input">filename</span>} | tail +6 | sed -e &#39;s/^+//&#39;`</span><table id='context7' class='context' style='display:none'><caption>lib/custom_linters/translations/view_translations_linter_helper.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>84</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def branch_changed_filenames_haml</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>    `git diff --name-only origin/trunk HEAD | grep .haml`.strip.split(&quot;\n&quot;).reject { |filename| filename.match(&#39;_spec.rb&#39;).present? }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def changed_lines_from_file_string(filename)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>    `git diff HEAD^ HEAD  --unified=0 #{filename} | tail +6 | sed -e &#39;s/^\+//&#39;`</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def approved_translation_strings_in_erb_tags</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>    {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>      :exact_match_strings =&gt; approved_exact_match_strings_in_erb,</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/store_registry_config.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context8');toggle('message8');toggle('full_message8')" >Possible command injection near line 18: <span class="code">`cp -r #{Rails.root}/system #{<span class="user_input">@target_config_folder</span>}`</span><table id='context8' class='context' style='display:none'><caption>lib/store_registry_config.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>13</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def current_configured_state_abbreviation</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    EnrollRegistry[:enroll_app].setting(:state_abbreviation).item.downcase</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def copy_current_system_configuration_to_storage</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>    `cp -r #{Rails.root}/system #{@target_config_folder}`</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def migrate</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @current_config_folder = current_config_folder</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @current_configured_state_abbreviation = current_configured_state_abbreviation</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/data_migrations/cancel_plan_years_group.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
        <td>[77]</td>
        <td><div class='warning_message' onClick="toggle('context9');toggle('message9');toggle('full_message9')" >Possible command injection near line 21: <span class="code">system(&quot;rake migrations:cancel_plan_year feins=&#39;#{<span class="user_input">row[&quot;FEIN&quot;]</span>}&#39; plan_year_state=&#39;#{row[&quot;aasm_state&quot;]}&#39;&quot;)</span><table id='context9' class='context' style='display:none'><caption>app/data_migrations/cancel_plan_years_group.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>16</pre>
          </td>
          <td class='context'>
            <pre class='context'>              puts &quot;canceled enrollments for ineligible plan year&quot; unless Rails.env.test?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>              plan_year.revert_application! if plan_year.may_revert_application?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>              plan_year.cancel! if plan_year.may_cancel?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>              puts &quot;canceled ineligible plan year for #{row[&#39;FEIN&#39;]}&quot; unless Rails.env.test?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>            else</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>              system(&quot;rake migrations:cancel_plan_year feins=&#39;#{row[&#39;FEIN&#39;]}&#39; plan_year_state=&#39;#{row[&#39;aasm_state&#39;]}&#39;&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>              puts &quot;Plan Year Cancelled for #{row[&#39;FEIN&#39;]}&quot; unless Rails.env.test?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>            end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>          else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>            puts &quot;Plan Year not found for ER #{row[&#39;FEIN&#39;]} with the #{row[&#39;start_on&#39;]} and #{row[&#39;aasm_state&#39;]}&quot; unless Rails.env.test?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/models/one_login/ruby_saml/saml_generator.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
        <td>[22]</td>
        <td><div class='warning_message' onClick="toggle('context13');toggle('message13');toggle('full_message13')" >Model attribute used in file name near line 38: <span class="code">File.read(<span class="user_input">SamlInformation.pay_now_private_key_location</span>)</span><table id='context13' class='context' style='display:none'><caption>app/models/one_login/ruby_saml/saml_generator.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>33</pre>
          </td>
          <td class='context'>
            <pre class='context'>        super()</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @transaction_id = transaction_id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @hbx_enrollment = hbx_enrollment</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if Rails.env.production?</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @private_key = OpenSSL::PKey::RSA.new(File.read(SamlInformation.pay_now_private_key_location))</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @cert = OpenSSL::X509::Certificate.new(File.read(SamlInformation.pay_now_x509_cert_location))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @private_key = OpenSSL::PKey::RSA.new(File.read(Rails.root.join(&#39;spec&#39;, &#39;test_data&#39;).to_s + &#39;/test_wfpk.pem&#39;))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @cert = OpenSSL::X509::Certificate.new(File.read(Rails.root.join(&#39;spec&#39;, &#39;test_data&#39;).to_s + &#39;/test_x509.pem&#39;))</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/models/one_login/ruby_saml/saml_generator.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
        <td>[22]</td>
        <td><div class='warning_message' onClick="toggle('context14');toggle('message14');toggle('full_message14')" >Model attribute used in file name near line 39: <span class="code">File.read(<span class="user_input">SamlInformation.pay_now_x509_cert_location</span>)</span><table id='context14' class='context' style='display:none'><caption>app/models/one_login/ruby_saml/saml_generator.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>34</pre>
          </td>
          <td class='context'>
            <pre class='context'>        @transaction_id = transaction_id</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @hbx_enrollment = hbx_enrollment</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if Rails.env.production?</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @private_key = OpenSSL::PKey::RSA.new(File.read(SamlInformation.pay_now_private_key_location))</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @cert = OpenSSL::X509::Certificate.new(File.read(SamlInformation.pay_now_x509_cert_location))</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @private_key = OpenSSL::PKey::RSA.new(File.read(Rails.root.join(&#39;spec&#39;, &#39;test_data&#39;).to_s + &#39;/test_wfpk.pem&#39;))</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>          @cert = OpenSSL::X509::Certificate.new(File.read(Rails.root.join(&#39;spec&#39;, &#39;test_data&#39;).to_s + &#39;/test_x509.pem&#39;))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/transcript_generator.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
        <td>[22]</td>
        <td><div class='warning_message' onClick="toggle('context15');toggle('message15');toggle('full_message15')" ><span id='message15' style='display:block'>Model attribute used in file name near line 47: ...</span><span id='full_message15' style='display:none'>Model attribute used in file name near line 47: <span class="code">File.open(&quot;#{TRANSCRIPT_PATH}/#{@count}_#{<span class="user_input">Transcripts::PersonTranscript.new.transcript[:identifier]</span>}_#{Time.now.to_i}.bin&quot;, &quot;wb&quot;)</span></span><table id='context15' class='context' style='display:none'><caption>lib/transcript_generator.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>42</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def build_transcript(external_obj)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    transcript = Transcripts::PersonTranscript.new</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # transcript.shop = false</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    transcript.find_or_build(external_obj)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    File.open(&quot;#{TRANSCRIPT_PATH}/#{@count}_#{transcript.transcript[:identifier]}_#{Time.now.to_i}.bin&quot;, &#39;wb&#39;) do |file|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      file.write Marshal.dump(transcript.transcript)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def display_enrollment_transcripts</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/controllers/documents_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
        <td>[22]</td>
        <td><div class='warning_message' onClick="toggle('context22');toggle('message22');toggle('full_message22')" >Model attribute used in file name near line 21: <span class="code">send_file(<span class="user_input">BenefitSponsors::Documents::EmployerAttestationDocument.find_by(:identifier =&gt; params[:path]).identifier</span>)</span><table id='context22' class='context' style='display:none'><caption>app/controllers/documents_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>16</pre>
          </td>
          <td class='context'>
            <pre class='context'>    send_data Aws::S3Storage.find(uri), get_options(params)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def download_employer_document</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document = BenefitSponsors::Documents::EmployerAttestationDocument.find_by(identifier: params[:path])</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.present? ? (send_file document.identifier) : redirect_back(fallback_location: root_path, :flash =&gt; {error: &quot;Document Not Found&quot;})</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>  rescue StandardError =&gt; e</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_back(fallback_location: root_path, :flash =&gt; {error: e.message})</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def authorized_download</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/controllers/employers/employer_profiles_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
        <td>[22]</td>
        <td><div class='warning_message' onClick="toggle('context23');toggle('message23');toggle('full_message23')" ><span id='message23' style='display:block'>Model attribute used in file name near line 255: ...</span><span id='full_message23' style='display:none'>Model attribute used in file name near line 255: <span class="code">send_file(<span class="user_input">EmployerProfile.find(params[:id]).documents.find(params[:ids][0]).identifier</span>, :file_name =&gt; EmployerProfile.find(params[:id]).documents.find(params[:ids][0]).title, :content_type =&gt; EmployerProfile.find(params[:id]).documents.find(params[:ids][0]).format)</span></span><table id='context23' class='context' style='display:none'><caption>app/controllers/employers/employer_profiles_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>251</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def download_documents # Should be in ER attestations controller</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>252</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @employer_profile = EmployerProfile.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>253</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #begin</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>254</pre>
            </td>
            <td class='context'>
              <pre class='context'>    doc = @employer_profile.documents.find(params[:ids][0])</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>255</pre>
            </td>
            <td class='context'>
              <pre class='context'>    doc.present? ? (send_file doc.identifier, file_name: doc.title, content_type: doc.format) : nil</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>257</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #render json: { status: 200, message: &#39;Successfully submitted the selected employer(s) for binder paid.&#39; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>258</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #rescue =&gt; e</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>259</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #  render json: { status: 500, message: &#39;An error occured while submitting employer(s) for binder paid.&#39; }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>260</pre>
            </td>
            <td class='context'>
              <pre class='context'>    #end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/notifier/app/controllers/notifier/notice_kinds_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
        <td>[22]</td>
        <td><div class='warning_message' onClick="toggle('context24');toggle('message24');toggle('full_message24')" ><span id='message24' style='display:block'>Model attribute used in file name near line 65: ...</span><span id='full_message24' style='display:none'>Model attribute used in file name near line 65: <span class="code">send_file(&quot;#{Rails.root}/tmp/#{<span class="user_input">Notifier::NoticeKind.find(params[:id]).notice_recipient.hbx_id</span>}_#{Notifier::NoticeKind.find(params[:id]).title.titleize.gsub(/\s+/, &quot;_&quot;)}.pdf&quot;, :type =&gt; &quot;application/pdf&quot;, :disposition =&gt; &quot;inline&quot;)</span></span><table id='context24' class='context' style='display:none'><caption>components/notifier/app/controllers/notifier/notice_kinds_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>61</pre>
          </td>
          <td class='context'>
            <pre class='context'>    def preview</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>      authorize ::Notifier::NoticeKind</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>      notice_kind = Notifier::NoticeKind.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>      notice_kind.generate_pdf_notice</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>      send_file &quot;#{Rails.root}/tmp/#{notice_kind.notice_recipient.hbx_id}_#{notice_kind.title.titleize.gsub(/\s+/, &#39;_&#39;)}.pdf&quot;,</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>                :type =&gt; &#39;application/pdf&#39;,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>                :disposition =&gt; &#39;inline&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def delete_notices</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/controllers/application_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
        <td>[915]</td>
        <td><div class='warning_message' onClick="toggle('context16');toggle('message16');toggle('full_message16')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 114: <span class="code">params.permit!</span><table id='context16' class='context' style='display:none'><caption>app/controllers/application_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>109</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def redirect_if_prod</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>    redirect_to root_path, :flash =&gt; { :error =&gt; &quot;Unable to run seeds on prod environment.&quot; } unless ENV[&#39;ENROLL_REVIEW_ENVIRONMENT&#39;] == &#39;true&#39; || !Rails.env.production?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def strong_params</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params.permit!</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>117</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def secure_message(from_provider, to_provider, subject, body)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>      message_params = {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>        sender_id: from_provider.id,</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/controllers/effective/datatables_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
        <td>[915]</td>
        <td><div class='warning_message' onClick="toggle('context17');toggle('message17');toggle('full_message17')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 7: <span class="code">params[:custom_attributes].permit!</span><table id='context17' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/controllers/effective/datatables_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>  class DatatablesController &lt; ApplicationController</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>    skip_log_page_views quiet: true if defined?(EffectiveLogging)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # This will respond to both a GET and a POST</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def show</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:custom_attributes].permit! if params[:custom_attributes].presence</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:attributes].permit! if params[:attributes].presence</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:scopes].permit! if params[:scopes].presence</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      attributes = (params[:attributes].presence || {}).merge(referer: request.referer).merge(custom_attributes: params.try(:custom_attributes, []))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>      scopes = (params[:scopes].presence || params[:custom_attributes].presence || {})</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/controllers/effective/datatables_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
        <td>[915]</td>
        <td><div class='warning_message' onClick="toggle('context18');toggle('message18');toggle('full_message18')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 8: <span class="code">params[:attributes].permit!</span><table id='context18' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/controllers/effective/datatables_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>    skip_log_page_views quiet: true if defined?(EffectiveLogging)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # This will respond to both a GET and a POST</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def show</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:custom_attributes].permit! if params[:custom_attributes].presence</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:attributes].permit! if params[:attributes].presence</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:scopes].permit! if params[:scopes].presence</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      attributes = (params[:attributes].presence || {}).merge(referer: request.referer).merge(custom_attributes: params.try(:custom_attributes, []))</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>      scopes = (params[:scopes].presence || params[:custom_attributes].presence || {})</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/controllers/effective/datatables_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
        <td>[915]</td>
        <td><div class='warning_message' onClick="toggle('context19');toggle('message19');toggle('full_message19')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 9: <span class="code">params[:scopes].permit!</span><table id='context19' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/controllers/effective/datatables_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>    # This will respond to both a GET and a POST</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def show</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:custom_attributes].permit! if params[:custom_attributes].presence</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:attributes].permit! if params[:attributes].presence</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>      params[:scopes].permit! if params[:scopes].presence</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      attributes = (params[:attributes].presence || {}).merge(referer: request.referer).merge(custom_attributes: params.try(:custom_attributes, []))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>      scopes = (params[:scopes].presence || params[:custom_attributes].presence || {})</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @datatable = find_datatable(params[:id]).try(:new, attributes.merge(scopes).to_hash)</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/simple_calendar/_month_calendar.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
        <td>[915]</td>
        <td><div class='warning_message' onClick="toggle('context44');toggle('message44');toggle('full_message44')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 2: <span class="code">params.merge(:start_date =&gt; (date_range.first - 1.day)).permit!</span><table id='context44' class='context' style='display:none'><caption>app/views/simple_calendar/_month_calendar.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;simple-calendar&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= link_to &quot;Previous&quot;, url_for(params.merge(start_date: date_range.first - 1.day).permit!), remote: true %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= I18n.t(&quot;date.month_names&quot;)[start_date.month] %&gt; &lt;%= start_date.year %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= link_to &quot;Next&quot;, url_for(params.merge(start_date: date_range.last + 1.day).permit!), remote: true  %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;table class=&quot;table table-striped&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;thead&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/simple_calendar/_month_calendar.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/mass_assignment/">Mass Assignment</a></td>
        <td>[915]</td>
        <td><div class='warning_message' onClick="toggle('context45');toggle('message45');toggle('full_message45')" >Specify exact keys allowed for mass assignment instead of using <span class="code">permit!</span> which allows any keys near line 4: <span class="code">params.merge(:start_date =&gt; (date_range.last + 1.day)).permit!</span><table id='context45' class='context' style='display:none'><caption>app/views/simple_calendar/_month_calendar.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;simple-calendar&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= link_to &quot;Previous&quot;, url_for(params.merge(start_date: date_range.first - 1.day).permit!), remote: true %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= I18n.t(&quot;date.month_names&quot;)[start_date.month] %&gt; &lt;%= start_date.year %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= link_to &quot;Next&quot;, url_for(params.merge(start_date: date_range.last + 1.day).permit!), remote: true  %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;table class=&quot;table table-striped&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;thead&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;tr&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% date_range.slice(0, 7).each do |day| %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/controllers/sponsored_benefits/organizations/plan_design_proposals/plans_controller.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context30');toggle('message30');toggle('full_message30')" ><span id='message30' style='display:block'>Html_safe used near line 31: ...</span><span id='full_message30' style='display:none'>Html_safe used near line 31: <span class="code">::Queries::EmployerPlanOfferings.new(plan_design_organization).dental_reference_plans_by_id(params[:plans_ids], params[:active_year]).select do  a.premium_tables.present?  end.map do  a.id.to_s  end.to_json.html_safe</span></span><table id='context30' class='context' style='display:none'><caption>components/sponsored_benefits/app/controllers/sponsored_benefits/organizations/plan_design_proposals/plans_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>27</pre>
          </td>
          <td class='context'>
            <pre class='context'>      def dental_reference_plans</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>        offering_query = ::Queries::EmployerPlanOfferings.new(plan_design_organization)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @plans = offering_query.dental_reference_plans_by_id(params[:plans_ids], params[:active_year])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @plans = @plans.select{|a| a.premium_tables.present?}</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @plans_ids_json = @plans&amp;.map{|a| a.id.to_s}&amp;.to_json&amp;.html_safe</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @search_options = ::Plan.search_options(@plans)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>        @search_option_titles = {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &#39;plan_type&#39;: EnrollRegistry.feature_enabled?(:hmo_ppo_plan_type) ? &#39;HMO / PPO&#39; : &#39;Plan Type&#39;,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &#39;plan_hsa&#39;: &#39;HSA - Compatible&#39;,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &#39;metal_level&#39;: &#39;Metal Level&#39;,</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/models/effective/mongoid_datatable.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context31');toggle('message31');toggle('full_message31')" >Html_safe used near line 18: <span class="code">I18n.t(translation_key, interpolated_keys.merge(:raise =&gt; true)).html_safe</span><table id='context31' class='context' style='display:none'><caption>app/models/effective/mongoid_datatable.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>13</pre>
          </td>
          <td class='context'>
            <pre class='context'>    def active_record_collection?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @active_record_collection ||= true</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def l10n(translation_key, interpolated_keys = {})</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>      I18n.t(translation_key, interpolated_keys.merge(raise: true)).html_safe</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>    rescue I18n::MissingTranslationData</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>      translation_key.gsub(/\W+/, &#39;&#39;).titleize</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def authorized?(_current_user, _controller, _action, _resource)</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Tables need to produce HTML - it is the responsibility of the table subclass to scrub.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/helpers/portal_header_helper.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context32');toggle('message32');toggle('full_message32')" >Html_safe used near line 130: <span class="code">l10n(*args).html_safe</span><table id='context32' class='context' style='display:none'><caption>app/helpers/portal_header_helper.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>125</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # rubocop:enable Metrics/AbcSize, Metrics/CyclomaticComplexity, Metrics/PerceivedComplexity</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def translated_header_portal_link(*args)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>    content_tag(&quot;a&quot;, class: &quot;portal&quot;) do</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>      l10n(*args).html_safe</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def portal_link_with_image_and_no_navigation(image_path, link_text, *args)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>    content_tag(&quot;a&quot;, *args) do</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Translations checked for user-created values.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/helpers/benefit_sponsors/portal_header_helper.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context33');toggle('message33');toggle('full_message33')" >Html_safe used near line 42: <span class="code">l10n(*args).html_safe</span><table id='context33' class='context' style='display:none'><caption>components/benefit_sponsors/app/helpers/benefit_sponsors/portal_header_helper.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>37</pre>
          </td>
          <td class='context'>
            <pre class='context'>    end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # rubocop:enable Layout/SpaceAroundOperators</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def translated_header_portal_link(*args)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>      content_tag(&quot;a&quot;, class: &quot;portal&quot;) do</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>        l10n(*args).html_safe</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def portal_link_with_image(image_path, link_text, *args)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>      link_to(*args) do</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Translation checked for user-created values.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/notifier/app/helpers/notifier/application_helper.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context34');toggle('message34');toggle('full_message34')" >Html_safe used near line 49: <span class="code">setting.html_safe</span><table id='context34' class='context' style='display:none'><caption>components/notifier/app/helpers/notifier/application_helper.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>44</pre>
          </td>
          <td class='context'>
            <pre class='context'>      end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def setting_portal_link(setting)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      content_tag(&quot;a&quot;, class: &quot;portal&quot;) do</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>        setting.html_safe</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def get_header_text(controller_name)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>      portal_display_name(controller_name)</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Checked for external parameters.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/html_scrubber_util.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context35');toggle('message35');toggle('full_message35')" ><span id='message35' style='display:block'>Html_safe used near line 10: ...</span><span id='full_message35' style='display:none'>Html_safe used near line 10: <span class="code">ActionController::Base.helpers.sanitize(value, :tags =&gt; Loofah::HTML5::SafeList::ACCEPTABLE_ELEMENTS.delete(&quot;select&quot;).merge([&quot;style&quot;, &quot;title&quot;]), :attributes =&gt; Loofah::HTML5::SafeList::ACCEPTABLE_ATTRIBUTES.add(&quot;style&quot;)).html_safe</span></span><table id='context35' class='context' style='display:none'><caption>lib/html_scrubber_util.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # Sanitizes a given value using rails sanitizers.</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  #</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # @param value [Object] The value to sanitize.</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # @return [ActiveSupport::SafeBuffer] The scrubbed value</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def sanitize_html(value)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ActionController::Base.helpers.sanitize(</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      value,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>      tags: Loofah::HTML5::SafeList::ACCEPTABLE_ELEMENTS.dup.delete(&quot;select&quot;).merge([&#39;style&#39;, &#39;title&#39;]),</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>      attributes: Loofah::HTML5::SafeList::ACCEPTABLE_ATTRIBUTES.dup.add(&quot;style&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ).html_safe</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>lib/pdf_scrubber_util.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context36');toggle('message36');toggle('full_message36')" ><span id='message36' style='display:block'>Html_safe used near line 10: ...</span><span id='full_message36' style='display:none'>Html_safe used near line 10: <span class="code">ActionController::Base.helpers.sanitize(value, :tags =&gt; Loofah::HTML5::SafeList::ACCEPTABLE_ELEMENTS.delete(&quot;select&quot;).add(&quot;style&quot;), :attributes =&gt; Loofah::HTML5::SafeList::ACCEPTABLE_ATTRIBUTES.add(&quot;style&quot;)).html_safe</span></span><table id='context36' class='context' style='display:none'><caption>lib/pdf_scrubber_util.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # Sanitizes a given value using a custom tag set.</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  #</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # @param value [Object] The value to sanitize.</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # @return [ActiveSupport::SafeBuffer] The scrubbed value</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def sanitize_pdf(value)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ActionController::Base.helpers.sanitize(</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      value,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>      tags: Loofah::HTML5::SafeList::ACCEPTABLE_ELEMENTS.dup.delete(&quot;select&quot;).add(&quot;style&quot;),</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>      attributes: Loofah::HTML5::SafeList::ACCEPTABLE_ATTRIBUTES.dup.add(&quot;style&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ).html_safe</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Safe called after explicit scrubbing.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/calc_employer_contributions.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context46');toggle('message46');toggle('full_message46')" >Html_safe used near line 2: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/plan_details&quot;, {})).html_safe</span><table id='context46' class='context' style='display:none'><caption>app/views/employers/plan_years/calc_employer_contributions.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>initial_summary_link = $(&#39;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt; &lt;%= @coverage_type %&gt;-view-summary a&#39;).attr(&#39;href&#39;);</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/plan_details&quot;)).html_safe %&gt;&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt; &lt;%= @coverage_type %&gt;-view-summary a&#39;).attr(&#39;href&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan h2.employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan .employee-monthly-cost-min&quot;).html(&quot;&lt;%= number_to_currency(@min_employee_cost.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan .employee-monthly-cost-max&quot;).html(&quot;&lt;%= number_to_currency(@max_employee_cost.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.benefits-fields&#39;).css(&#39;pointer-events&#39;,&#39;&#39;);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial render update via javascript - used template is checked already.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/calc_offered_plan_contributions.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context47');toggle('message47');toggle('full_message47')" >Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/plan_details&quot;, { :locals =&gt; ({ :is_edit =&gt; params[:is_edit], :calc_offered =&gt; true }) })).html_safe</span><table id='context47' class='context' style='display:none'><caption>app/views/employers/plan_years/calc_offered_plan_contributions.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/plan_details&quot;, locals: { is_edit: @is_edit, calc_offered: true } )).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan h2.employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan .employee-monthly-cost-min&quot;).html(&quot;&lt;%= number_to_currency(@min_employee_cost.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan .employee-monthly-cost-max&quot;).html(&quot;&lt;%= number_to_currency(@max_employee_cost.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan&quot;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt; .reference-steps&quot;).show();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial render update via javascript - used template is checked already.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context48');toggle('message48');toggle('full_message48')" >Html_safe used near line 9: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/dental_plans&quot;, {})).html_safe</span><table id='context48' class='context' style='display:none'><caption>app/views/employers/plan_years/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>    $(&#39;#&lt;%= @location_id %&gt; .dental .nav-tabs label:contains(&quot;By carrier&quot;)&#39;).on(&#39;click&#39;, function() {</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(&#39;#&lt;%= @location_id %&gt; .dental .elected-plans-continue&#39;).hide();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    });</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  } else {</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .elected-plans-tab&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/dental_plans&quot;)).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .elected-plans-tab&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .dental .plan-options&#39;).slideDown(&#39;400&#39;, function() {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    $(&#39;#&lt;%= @location_id %&gt; .elected-plans-continue&#39;).fadeIn();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>  });</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial render update via javascript - used template is checked already.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context49');toggle('message49');toggle('full_message49')" >Html_safe used near line 44: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/dental_plans&quot;, {})).html_safe</span><table id='context49' class='context' style='display:none'><caption>app/views/employers/plan_years/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .select-dental-plan .edit-offering&#39;).hide();</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .select-dental-plan .reference-steps div:first&#39;).hide();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>} else {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .dental-reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/dental_plans&quot;)).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if @carrier_profile == &#39;all_plans&#39; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .dental-plan-offering&#39;).hide();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .reference-steps .dental:first&#39;).hide();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .elected-plans-tab input:not(:checked)&#39;).each(function() {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var plan_value = $(this).attr(&#39;value&#39;);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial render update via javascript - used template is checked already.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/exchanges/hbx_profiles/_new_benefit_application.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context50');toggle('message50');toggle('full_message50')" >Html_safe used near line 129: <span class="code">BenefitSponsors::Forms::BenefitApplicationForm.for_new(new_ba_params).start_on_options.to_json.html_safe</span><table id='context50' class='context' style='display:none'><caption>app/views/exchanges/hbx_profiles/_new_benefit_application.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>124</pre>
          </td>
          <td class='context'>
            <pre class='context'>    document.querySelector(&quot;input#open_enrollment_start_on&quot;).value = &#39;&#39;;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_end_on&quot;).value = &#39;&#39;;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>  function assignBenefitApplicationDates(targetDate) {</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var date = JSON.parse(&#39;#{@ba_form.start_on_options.to_json.html_safe}&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&#39;input#end_on&#39;).value = getFormattedDate(date[targetDate][&quot;benefit_application_end_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_start_on&quot;).value = getFormattedDate(date[targetDate][&quot;open_enrollment_start_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_end_on&quot;).value = getFormattedDate(date[targetDate][&quot;open_enrollment_end_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>JSON serialization is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/exchanges/hbx_profiles/_new_benefit_application.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context51');toggle('message51');toggle('full_message51')" >Html_safe used near line 129: <span class="code">@ba_form.start_on_options.to_json.html_safe</span><table id='context51' class='context' style='display:none'><caption>app/views/exchanges/hbx_profiles/_new_benefit_application.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>124</pre>
          </td>
          <td class='context'>
            <pre class='context'>    document.querySelector(&quot;input#open_enrollment_start_on&quot;).value = &#39;&#39;;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_end_on&quot;).value = &#39;&#39;;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>  function assignBenefitApplicationDates(targetDate) {</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var date = JSON.parse(&#39;#{@ba_form.start_on_options.to_json.html_safe}&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&#39;input#end_on&#39;).value = getFormattedDate(date[targetDate][&quot;benefit_application_end_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_start_on&quot;).value = getFormattedDate(date[targetDate][&quot;open_enrollment_start_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_end_on&quot;).value = getFormattedDate(date[targetDate][&quot;open_enrollment_end_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>JSON serialization is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context52');toggle('message52');toggle('full_message52')" >Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;sponsored_benefits/organizations/plan_design_proposals/shared/pdp_plan_details&quot;, {})).html_safe</span><table id='context52' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/pdp_plan_details&#39;)).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;.selected-plan .employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if benefit_group.sole_source? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/employee_composite_costs&#39;, locals: { benefit_group: benefit_group })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% else %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Render update via javascript - the used template is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context53');toggle('message53');toggle('full_message53')" >Html_safe used near line 5: <span class="code">escape_javascript(render(partial =&gt; &quot;sponsored_benefits/organizations/plan_design_proposals/shared/employee_composite_costs&quot;, { :locals =&gt; ({ :benefit_group =&gt; benefit_group }) })).html_safe</span><table id='context53' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/pdp_plan_details&#39;)).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;.selected-plan .employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if benefit_group.sole_source? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/employee_composite_costs&#39;, locals: { benefit_group: benefit_group })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/benefit_group_cost_summary&#39;, locals: { benefit_group: benefit_group, kind: kind})).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Render update via javascript - the used template is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context54');toggle('message54');toggle('full_message54')" >Html_safe used near line 7: <span class="code">escape_javascript(render(partial =&gt; &quot;sponsored_benefits/organizations/plan_design_proposals/shared/benefit_group_cost_summary&quot;, { :locals =&gt; ({ :benefit_group =&gt; benefit_group, :kind =&gt; kind }) })).html_safe</span><table id='context54' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&quot;.selected-plan .employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if benefit_group.sole_source? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/employee_composite_costs&#39;, locals: { benefit_group: benefit_group })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/benefit_group_cost_summary&#39;, locals: { benefit_group: benefit_group, kind: kind})).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Render update via javascript - the used template is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context55');toggle('message55');toggle('full_message55')" ><span id='message55' style='display:block'>Html_safe used near line 1: ...</span><span id='full_message55' style='display:none'>Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;plans&quot;, { :locals =&gt; ({ :plans =&gt; (::Queries::EmployerPlanOfferings.new(plan_design_organization).dental_reference_plans_by_id(params[:plans_ids], params[:active_year]).select do  a.premium_tables.present?  end) }) })).html_safe</span></span><table id='context55' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#elected_dental_plans&quot;).val(&#39;&lt;%= @plans_ids_json %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Render update via javascript - the used template is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context56');toggle('message56');toggle('full_message56')" ><span id='message56' style='display:block'>Html_safe used near line 2: ...</span><span id='full_message56' style='display:none'>Html_safe used near line 2: <span class="code">escape_javascript(render(partial =&gt; &quot;plan_search_fields&quot;, { :locals =&gt; ({ :search_options =&gt; ::Plan.search_options(::Queries::EmployerPlanOfferings.new(plan_design_organization).dental_reference_plans_by_id(params[:plans_ids], params[:active_year]).select do  a.premium_tables.present?  end), :search_titles =&gt; ({ :plan_type =&gt; (if EnrollRegistry.feature_enabled?(:hmo_ppo_plan_type) then   &quot;HMO / PPO&quot; else   &quot;Plan Type&quot; end), :plan_hsa =&gt; &quot;HSA - Compatible&quot;, :metal_level =&gt; &quot;Metal Level&quot;, :plan_deductible =&gt; &quot;Individual deductible (in network)&quot; }) }) })).html_safe</span></span><table id='context56' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#elected_dental_plans&quot;).val(&#39;&lt;%= @plans_ids_json %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Render update via javascript - used template is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context57');toggle('message57');toggle('full_message57')" ><span id='message57' style='display:block'>Html_safe used near line 4: ...</span><span id='full_message57' style='display:none'>Html_safe used near line 4: <span class="code">::Queries::EmployerPlanOfferings.new(plan_design_organization).dental_reference_plans_by_id(params[:plans_ids], params[:active_year]).select do  a.premium_tables.present?  end.map do  a.id.to_s  end.to_json.html_safe</span></span><table id='context57' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#elected_dental_plans&quot;).val(&#39;&lt;%= @plans_ids_json %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context58');toggle('message58');toggle('full_message58')" ><span id='message58' style='display:block'>Html_safe used near line 1: ...</span><span id='full_message58' style='display:none'>Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;plans&quot;, { :locals =&gt; ({ :plans =&gt; ((((::Queries::EmployerPlanOfferings.new(plan_design_organization).send(&quot;single_carrier_offered_#{kind}_plans&quot;, params[:carrier_id], params[:active_year]) or ::Queries::EmployerPlanOfferings.new(plan_design_organization).metal_level_offered_health_plans(params[:metal_level], params[:active_year])) or ::Queries::EmployerPlanOfferings.new(plan_design_organization).send(&quot;single_option_offered_#{kind}_plans&quot;, params[:carrier_id], params[:active_year])) or ::Queries::EmployerPlanOfferings.new(plan_design_organization).sole_source_offered_health_plans(params[:carrier_id], params[:active_year])).select do  a.premium_tables.present?  end) }) })).html_safe</span></span><table id='context58' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Render update via javascript - the used template is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context59');toggle('message59');toggle('full_message59')" ><span id='message59' style='display:block'>Html_safe used near line 2: ...</span><span id='full_message59' style='display:none'>Html_safe used near line 2: <span class="code">escape_javascript(render(partial =&gt; &quot;plan_search_fields&quot;, { :locals =&gt; ({ :search_options =&gt; ::Plan.search_options((((::Queries::EmployerPlanOfferings.new(plan_design_organization).send(&quot;single_carrier_offered_#{kind}_plans&quot;, params[:carrier_id], params[:active_year]) or ::Queries::EmployerPlanOfferings.new(plan_design_organization).metal_level_offered_health_plans(params[:metal_level], params[:active_year])) or ::Queries::EmployerPlanOfferings.new(plan_design_organization).send(&quot;single_option_offered_#{kind}_plans&quot;, params[:carrier_id], params[:active_year])) or ::Queries::EmployerPlanOfferings.new(plan_design_organization).sole_source_offered_health_plans(params[:carrier_id], params[:active_year])).select do  a.premium_tables.present?  end), :search_titles =&gt; ({ :plan_type =&gt; ((Settings.aca.state_abbreviation == &quot;DC&quot;) ? (&quot;Plan Type&quot;) : (&quot;HMO / PPO&quot;)), :plan_hsa =&gt; &quot;HSA - Compatible&quot;, :metal_level =&gt; &quot;Metal Level&quot;, :plan_deductible =&gt; &quot;Individual deductible (in network)&quot; }) }) })).html_safe</span></span><table id='context59' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Render update via javascript - the used template is already checked.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/views/benefit_sponsors/benefit_applications/benefit_applications/shared/_benefit_application_fields.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context60');toggle('message60');toggle('full_message60')" >Html_safe used near line 107: <span class="code">@benefit_application_form.start_on_options.to_json.html_safe</span><table id='context60' class='context' style='display:none'><caption>components/benefit_sponsors/app/views/benefit_sponsors/benefit_applications/benefit_applications/shared/_benefit_application_fields.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>102</pre>
          </td>
          <td class='context'>
            <pre class='context'>  var monthName = [&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &quot;July&quot;, &quot;Aug&quot;, &quot;Sept&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>  ];</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>  function assignBenefitApplicationDates(targetDate) {</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>107</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var date = JSON.parse(&#39;#{@benefit_application_form.start_on_options.to_json.html_safe}&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var latest_submitted_on = date[targetDate][&quot;employer_initial_application_latest_submit_on&quot;];</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var binder_payment_deadline = date[targetDate][&quot;binder_payment_due_date&quot;];</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var latest_submitted_on_date = stringToDate(latest_submitted_on);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var binder_payment_deadline_date = stringToDate(binder_payment_deadline);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>JSON serialization already checks for XSS.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/views/benefit_sponsors/benefit_applications/benefit_applications/shared/_benefit_application_fields.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context61');toggle('message61');toggle('full_message61')" >Html_safe used near line 166: <span class="code">@benefit_application_form.start_on_options.to_json.html_safe</span><table id='context61' class='context' style='display:none'><caption>components/benefit_sponsors/app/views/benefit_sponsors/benefit_applications/benefit_applications/shared/_benefit_application_fields.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>161</pre>
          </td>
          <td class='context'>
            <pre class='context'>    }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>162</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>164</pre>
            </td>
            <td class='context'>
              <pre class='context'>  function showDatepicker(id) {</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>165</pre>
            </td>
            <td class='context'>
              <pre class='context'>    //selectedDate(document.getElementById(&quot;baStartDate&quot;));</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>166</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var date = JSON.parse(&#39;#{@benefit_application_form.start_on_options.to_json.html_safe}&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>167</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var targetDate = document.getElementById(&quot;baStartDate&quot;).value</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>168</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var minDate = document.querySelector(&quot;input#benefit_application_open_enrollment_start_on&quot;).dataset.dateMin;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>169</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var open_enrollment_end_on = document.querySelector(&quot;input#benefit_application_open_enrollment_end_on&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var maxDate  = $(open_enrollment_end_on).attr(&quot;data-oe-max-Date&quot;) || $(open_enrollment_end_on).attr(&quot;data-oe-end-date&quot;);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>JSON serialization already checks for XSS.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/views/benefit_sponsors/benefit_packages/benefit_packages/_product_choices.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context62');toggle('message62');toggle('full_message62')" >Html_safe used near line 185: <span class="code">@benefit_package_form.catalog.plan_options.to_json.html_safe</span><table id='context62' class='context' style='display:none'><caption>components/benefit_sponsors/app/views/benefit_sponsors/benefit_packages/benefit_packages/_product_choices.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>181</pre>
          </td>
          <td class='context'>
            <pre class='context'>      var product_option_kind = $(&#39;.product-options-tab input[type=radio]:checked&#39;).val();</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>182</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var selected_radio = event.target.value;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>183</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var location_id = $(this).closest(&#39;.benefit-group-fields&#39;).attr(&#39;id&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>185</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var plan_options = &lt;%= @benefit_package_form.catalog.plan_options.to_json.html_safe %&gt;;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var filtered_products = plan_options[product_option_kind][selected_radio];</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>      initPlanOptions(filtered_products, location_id);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>190</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var sponsor_contributions = &lt;%= @benefit_package_form.catalog.sponsor_contributions(@benefit_package_form.id).to_json.html_safe %&gt;;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>JSON serialization already checks for XSS.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/views/benefit_sponsors/benefit_packages/benefit_packages/_product_choices.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context63');toggle('message63');toggle('full_message63')" >Html_safe used near line 190: <span class="code">@benefit_package_form.catalog.sponsor_contributions(@benefit_package_form.id).to_json.html_safe</span><table id='context63' class='context' style='display:none'><caption>components/benefit_sponsors/app/views/benefit_sponsors/benefit_packages/benefit_packages/_product_choices.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>185</pre>
          </td>
          <td class='context'>
            <pre class='context'>      var plan_options = &lt;%= @benefit_package_form.catalog.plan_options.to_json.html_safe %&gt;;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>186</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var filtered_products = plan_options[product_option_kind][selected_radio];</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>188</pre>
            </td>
            <td class='context'>
              <pre class='context'>      initPlanOptions(filtered_products, location_id);</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>190</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var sponsor_contributions = &lt;%= @benefit_package_form.catalog.sponsor_contributions(@benefit_package_form.id).to_json.html_safe %&gt;;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>191</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var sponsor_contribution = sponsor_contributions[product_option_kind];</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>193</pre>
            </td>
            <td class='context'>
              <pre class='context'>      initSponsorContributions(sponsor_contribution, location_id);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>195</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(document).on(&#39;click&#39;, &quot;.reference-plan input[type=&#39;radio&#39;]&quot;, function(event){</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>JSON serialization already checks for XSS.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/views/benefit_sponsors/sponsored_benefits/sponsored_benefits/_sponsored_benefit.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context64');toggle('message64');toggle('full_message64')" >Html_safe used near line 112: <span class="code">@sponsored_benefit_form.employees_cost.to_json.html_safe</span><table id='context64' class='context' style='display:none'><caption>components/benefit_sponsors/app/views/benefit_sponsors/sponsored_benefits/sponsored_benefits/_sponsored_benefit.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>107</pre>
          </td>
          <td class='context'>
            <pre class='context'>      table.querySelectorAll(&#39;tr&#39;).forEach(function(element) {</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>        element.remove()</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>        });</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var tr = document.createElement(&#39;tr&#39;)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var estimate = #{@sponsored_benefit_form.employees_cost.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var productOptionKind = &#39;multi_product&#39;;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var productsTotal;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var planOptions = #{@sponsored_benefit_form.catalog.plan_options.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var element = document.querySelector(&quot;input[name=&#39;sponsored_benefits[reference_plan_id]&#39;]:checked&quot;);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/views/benefit_sponsors/sponsored_benefits/sponsored_benefits/_sponsored_benefit.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context65');toggle('message65');toggle('full_message65')" >Html_safe used near line 115: <span class="code">@sponsored_benefit_form.catalog.plan_options.to_json.html_safe</span><table id='context65' class='context' style='display:none'><caption>components/benefit_sponsors/app/views/benefit_sponsors/sponsored_benefits/sponsored_benefits/_sponsored_benefit.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>111</pre>
          </td>
          <td class='context'>
            <pre class='context'>      var tr = document.createElement(&#39;tr&#39;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>112</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var estimate = #{@sponsored_benefit_form.employees_cost.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var productOptionKind = &#39;multi_product&#39;;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var productsTotal;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>115</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var planOptions = #{@sponsored_benefit_form.catalog.plan_options.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>116</pre>
            </td>
            <td class='context'>
              <pre class='context'>      var element = document.querySelector(&quot;input[name=&#39;sponsored_benefits[reference_plan_id]&#39;]:checked&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>118</pre>
            </td>
            <td class='context'>
              <pre class='context'>      // var selectedName = element.dataset.carrierName;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>119</pre>
            </td>
            <td class='context'>
              <pre class='context'>      // var planTitle = element.dataset.planTitle;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>120</pre>
            </td>
            <td class='context'>
              <pre class='context'>      // filteredProducts = planOptions[productOptionKind][selectedName];</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/views/benefit_sponsors/sponsored_benefits/sponsored_benefits/_sponsored_benefit.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context66');toggle('message66');toggle('full_message66')" >Html_safe used near line 153: <span class="code">@sponsored_benefit_form.catalog.plan_options.to_json.html_safe</span><table id='context66' class='context' style='display:none'><caption>components/benefit_sponsors/app/views/benefit_sponsors/sponsored_benefits/sponsored_benefits/_sponsored_benefit.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>148</pre>
          </td>
          <td class='context'>
            <pre class='context'>  var eeContribution;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>149</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var spouse;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var domesticPartner;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>151</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var childUnder26;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var contributionInputs;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var planOptions = #{@sponsored_benefit_form.catalog.plan_options.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsorContributions = #{@sponsored_benefit_form.catalog.sponsor_contributions(@sponsored_benefit_form.benefit_package_id).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>155</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsoredBenefitId;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var tempContributionValues = {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>158</pre>
            </td>
            <td class='context'>
              <pre class='context'>    eeContribution:eeContribution || 0,</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/benefit_sponsors/app/views/benefit_sponsors/sponsored_benefits/sponsored_benefits/_sponsored_benefit.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context67');toggle('message67');toggle('full_message67')" >Html_safe used near line 154: <span class="code">@sponsored_benefit_form.catalog.sponsor_contributions(@sponsored_benefit_form.benefit_package_id).to_json.html_safe</span><table id='context67' class='context' style='display:none'><caption>components/benefit_sponsors/app/views/benefit_sponsors/sponsored_benefits/sponsored_benefits/_sponsored_benefit.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>149</pre>
          </td>
          <td class='context'>
            <pre class='context'>  var spouse;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>150</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var domesticPartner;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>151</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var childUnder26;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var contributionInputs;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var planOptions = #{@sponsored_benefit_form.catalog.plan_options.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsorContributions = #{@sponsored_benefit_form.catalog.sponsor_contributions(@sponsored_benefit_form.benefit_package_id).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>155</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsoredBenefitId;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var tempContributionValues = {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>158</pre>
            </td>
            <td class='context'>
              <pre class='context'>    eeContribution:eeContribution || 0,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>159</pre>
            </td>
            <td class='context'>
              <pre class='context'>    spouse:spouse || 0,</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/views/effective/datatables/_datatable.html.haml</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context68');toggle('message68');toggle('full_message68')" >Html_safe used near line 42: <span class="code">col.to_s.html_safe</span><table id='context68' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/views/effective/datatables/_datatable.html.haml</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>38</pre>
          </td>
          <td class='context'>
            <pre class='context'>        %tbody</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>          - datatable.to_json[:data].each do |row|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>            %tr</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>              - row.each do |col|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>                %td= col.to_s.html_safe</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>        - if datatable.aggregates.present?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>          %tfoot</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>            - datatable.to_json[:aggregates].each do |row|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>              %tr</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Datatable columns must be rendered as is.  It is the responsibility of the table object to do any scrubbing.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/views/effective/datatables/_datatable.html.haml</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context69');toggle('message69');toggle('full_message69')" >Html_safe used near line 49: <span class="code">col.to_s.html_safe</span><table id='context69' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/views/effective/datatables/_datatable.html.haml</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>44</pre>
          </td>
          <td class='context'>
            <pre class='context'>        - if datatable.aggregates.present?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>          %tfoot</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>            - datatable.to_json[:aggregates].each do |row|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>              %tr</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>                - row.each do |col|</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  %td= col.to_s.html_safe</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Datatable columns must be rendered as is.  It is the responsibility of the table object to do any scrubbing.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/calc_employer_contributions.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context70');toggle('message70');toggle('full_message70')" >Html_safe used near line 2: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/plan_details&quot;, {})).html_safe</span><table id='context70' class='context' style='display:none'><caption>app/views/employers/plan_years/calc_employer_contributions.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>initial_summary_link = $(&#39;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt; &lt;%= @coverage_type %&gt;-view-summary a&#39;).attr(&#39;href&#39;);</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/plan_details&quot;)).html_safe %&gt;&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt; &lt;%= @coverage_type %&gt;-view-summary a&#39;).attr(&#39;href&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan h2.employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan .employee-monthly-cost-min&quot;).html(&quot;&lt;%= number_to_currency(@min_employee_cost.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan .employee-monthly-cost-max&quot;).html(&quot;&lt;%= number_to_currency(@max_employee_cost.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.benefits-fields&#39;).css(&#39;pointer-events&#39;,&#39;&#39;);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/calc_offered_plan_contributions.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context71');toggle('message71');toggle('full_message71')" >Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/plan_details&quot;, { :locals =&gt; ({ :is_edit =&gt; (@is_edit), :calc_offered =&gt; true }) })).html_safe</span><table id='context71' class='context' style='display:none'><caption>app/views/employers/plan_years/calc_offered_plan_contributions.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/plan_details&quot;, locals: { is_edit: @is_edit, calc_offered: true } )).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan h2.employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan .employee-monthly-cost-min&quot;).html(&quot;&lt;%= number_to_currency(@min_employee_cost.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan .employee-monthly-cost-max&quot;).html(&quot;&lt;%= number_to_currency(@max_employee_cost.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt;.selected-plan&quot;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#&lt;%= @location_id %&gt; &lt;%= @coverage_type %&gt; .reference-steps&quot;).show();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context72');toggle('message72');toggle('full_message72')" >Html_safe used near line 9: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/dental_plans&quot;, {})).html_safe</span><table id='context72' class='context' style='display:none'><caption>app/views/employers/plan_years/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>4</pre>
          </td>
          <td class='context'>
            <pre class='context'>    $(&#39;#&lt;%= @location_id %&gt; .dental .nav-tabs label:contains(&quot;By carrier&quot;)&#39;).on(&#39;click&#39;, function() {</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>      $(&#39;#&lt;%= @location_id %&gt; .dental .elected-plans-continue&#39;).hide();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>    });</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  } else {</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .elected-plans-tab&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/dental_plans&quot;)).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .elected-plans-tab&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .dental .plan-options&#39;).slideDown(&#39;400&#39;, function() {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    $(&#39;#&lt;%= @location_id %&gt; .elected-plans-continue&#39;).fadeIn();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>  });</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context73');toggle('message73');toggle('full_message73')" >Html_safe used near line 44: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/dental_plans&quot;, {})).html_safe</span><table id='context73' class='context' style='display:none'><caption>app/views/employers/plan_years/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .select-dental-plan .edit-offering&#39;).hide();</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= @location_id %&gt; .select-dental-plan .reference-steps div:first&#39;).hide();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>} else {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .dental-reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/dental_plans&quot;)).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if @carrier_profile == &#39;all_plans&#39; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .dental-plan-offering&#39;).hide();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .reference-steps .dental:first&#39;).hide();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .elected-plans-tab input:not(:checked)&#39;).each(function() {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var plan_value = $(this).attr(&#39;value&#39;);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/plan_details.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context74');toggle('message74');toggle('full_message74')" >Html_safe used near line 2: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/plan_details&quot;, {})).html_safe</span><table id='context74' class='context' style='display:none'><caption>app/views/employers/plan_years/plan_details.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;#&lt;%= @benefit_group %&gt; .selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/plan_details&quot;)).html_safe %&gt;&quot;);</pre>
          </td>
        </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/employers/plan_years/reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context75');toggle('message75');toggle('full_message75')" >Html_safe used near line 2: <span class="code">escape_javascript(render(partial =&gt; &quot;employers/plan_years/plan_selection/single_carriers&quot;, { :locals =&gt; ({ :plans =&gt; (@plans), :benefit_group =&gt; (@benefit_group) }) })).html_safe</span><table id='context75' class='context' style='display:none'><caption>app/views/employers/plan_years/reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .reference-plans&#39;).html(&quot;&lt;div class=&#39;col-xs-12 health select-reference&#39;&gt;&lt;br&gt;&lt;br&gt;&lt;h2 class=&#39;row&#39;&gt;Select Your Reference Plan&lt;/h2&gt;&lt;p style=&#39;position: relative;&#39; class=&#39;row twenty&#39;&gt;&lt;span class=&#39;starter&#39; style=&#39;display: inline-block;&#39;&gt;Now select a reference plan. The reference plan is used to cap employer costs. You’ll choose a reference plan. Then, your contribution towards employee premiums will be applied to the reference plan you choose regardless of which plans your employees select. After you select your reference plan, scroll down to review your costs.&lt;/span&gt;&lt;span style=&#39;position: absolute; right: 0; bottom: 0;&#39;&gt;Displaying: &lt;strong&gt;&lt;%= @plans.count %&gt; Plans&lt;/strong&gt; &lt;/span&gt;&lt;/p&gt;&lt;br/&gt;&lt;/div&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .reference-plans&#39;).append(&quot;&lt;%= escape_javascript(render(partial: &quot;employers/plan_years/plan_selection/single_carriers&quot;, locals: { :plans =&gt; @plans, :benefit_group =&gt; @benefit_group  })).html_safe %&gt;&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .reference-plans&#39;).css({ &quot;height&quot;: &quot;450px&quot;, &quot;y-overflow&quot;: &quot;scroll&quot; })</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;#&lt;%= @location_id %&gt; .health .reference-plan .col-xs-2&#39;).on(&#39;click&#39;, function() {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  if ($(this).find(&#39;input[type=radio]&#39;).is(&#39;:checked&#39;)) {</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/events/v2/employers/group_xml.haml</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context76');toggle('message76');toggle('full_message76')" >Html_safe used near line 20: <span class="code">organization[2].html_safe</span><table id='context76' class='context' style='display:none'><caption>app/views/events/v2/employers/group_xml.haml</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>15</pre>
          </td>
          <td class='context'>
            <pre class='context'>          %event_name= organization[0]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>          %resource_instance_uri</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>            - doc = Nokogiri::XML(organization[2])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>            %id=&quot;urn:openhbx:resource:organization:id##{doc.at(&#39;organization/id/id&#39;).text}&quot;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>          %body</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>            = organization[2].html_safe</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>XML format - no need for scrubbing.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/exchanges/hbx_profiles/_new_benefit_application.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context77');toggle('message77');toggle('full_message77')" >Html_safe used near line 129: <span class="code">@ba_form.start_on_options.to_json.html_safe</span><table id='context77' class='context' style='display:none'><caption>app/views/exchanges/hbx_profiles/_new_benefit_application.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>124</pre>
          </td>
          <td class='context'>
            <pre class='context'>    document.querySelector(&quot;input#open_enrollment_start_on&quot;).value = &#39;&#39;;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_end_on&quot;).value = &#39;&#39;;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>  function assignBenefitApplicationDates(targetDate) {</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var date = JSON.parse(&#39;#{@ba_form.start_on_options.to_json.html_safe}&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&#39;input#end_on&#39;).value = getFormattedDate(date[targetDate][&quot;benefit_application_end_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_start_on&quot;).value = getFormattedDate(date[targetDate][&quot;open_enrollment_start_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>    document.querySelector(&quot;input#open_enrollment_end_on&quot;).value = getFormattedDate(date[targetDate][&quot;open_enrollment_end_on&quot;]);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>  }</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/people/_get_employer.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context78');toggle('message78');toggle('full_message78')" >Html_safe used near line 4: <span class="code">escape_javascript(render(partial =&gt; &quot;people/employers&quot;, {})).html_safe</span><table id='context78' class='context' style='display:none'><caption>app/views/people/_get_employer.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;#new_person_wrapper&#39;).html(&quot;&lt;%= escape_javascript(render &quot;people/person_form&quot;) %&gt;&quot;);</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if @employer_profile.present? %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#employer-info&#39;).html(&quot;&lt;%= escape_javascript(render &#39;people/employers&#39;).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;#key-section&quot;).removeClass(&quot;hidden&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;.search-btn-row&#39;).addClass(&#39;hidden&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;.employer_info&#39;).removeClass(&#39;hidden&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#employer-info&#39;).removeClass(&#39;hidden&#39;);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/people/get_employer.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context79');toggle('message79');toggle('full_message79')" >Html_safe used near line 4: <span class="code">escape_javascript(render(partial =&gt; &quot;employers&quot;, {})).html_safe</span><table id='context79' class='context' style='display:none'><caption>app/views/people/get_employer.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;#new_person_wrapper&#39;).html(&quot;&lt;%= escape_javascript(render &quot;person_form&quot;) %&gt;&quot;);</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if @employer_profile.present? %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#employer-info&#39;).html(&quot;&lt;%= escape_javascript(render &#39;employers&#39;).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;#key-section&quot;).removeClass(&quot;hidden&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;.search-btn-row&#39;).addClass(&#39;hidden&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;.employer_info&#39;).removeClass(&#39;hidden&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#employer-info&#39;).removeClass(&#39;hidden&#39;);</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/people/person_confirm.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context80');toggle('message80');toggle('full_message80')" >Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;person_confirm&quot;, {})).html_safe</span><table id='context80' class='context' style='display:none'><caption>app/views/people/person_confirm.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.employers-row&#39;).html(&quot;&lt;%= escape_javascript(render &#39;person_confirm&#39;).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context81');toggle('message81');toggle('full_message81')" >Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;sponsored_benefits/organizations/plan_design_proposals/shared/pdp_plan_details&quot;, {})).html_safe</span><table id='context81' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/pdp_plan_details&#39;)).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;.selected-plan .employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if benefit_group.sole_source? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/employee_composite_costs&#39;, locals: { benefit_group: benefit_group })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% else %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context82');toggle('message82');toggle('full_message82')" >Html_safe used near line 5: <span class="code">escape_javascript(render(partial =&gt; &quot;sponsored_benefits/organizations/plan_design_proposals/shared/employee_composite_costs&quot;, { :locals =&gt; ({ :benefit_group =&gt; benefit_group }) })).html_safe</span><table id='context82' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.selected-plan&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/pdp_plan_details&#39;)).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;.selected-plan .employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if benefit_group.sole_source? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/employee_composite_costs&#39;, locals: { benefit_group: benefit_group })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/benefit_group_cost_summary&#39;, locals: { benefit_group: benefit_group, kind: kind})).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript.  The used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context83');toggle('message83');toggle('full_message83')" >Html_safe used near line 7: <span class="code">escape_javascript(render(partial =&gt; &quot;sponsored_benefits/organizations/plan_design_proposals/shared/benefit_group_cost_summary&quot;, { :locals =&gt; ({ :benefit_group =&gt; benefit_group, :kind =&gt; kind }) })).html_safe</span><table id='context83' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/contributions/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&quot;.selected-plan .employer-monthly-cost&quot;).html(&quot;&lt;%= number_to_currency(@employer_contribution_amount.to_f) %&gt;&quot;);</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% if benefit_group.sole_source? %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/employee_composite_costs&#39;, locals: { benefit_group: benefit_group })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&quot;.employee-costs&quot;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;sponsored_benefits/organizations/plan_design_proposals/shared/benefit_group_cost_summary&#39;, locals: { benefit_group: benefit_group, kind: kind})).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;% end %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript.  The used template has already been cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context84');toggle('message84');toggle('full_message84')" >Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;plans&quot;, { :locals =&gt; ({ :plans =&gt; (@plans) }) })).html_safe</span><table id='context84' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#elected_dental_plans&quot;).val(&#39;&lt;%= @plans_ids_json %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template is already cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context85');toggle('message85');toggle('full_message85')" >Html_safe used near line 2: <span class="code">escape_javascript(render(partial =&gt; &quot;plan_search_fields&quot;, { :locals =&gt; ({ :search_options =&gt; (@search_options), :search_titles =&gt; (@search_option_titles) }) })).html_safe</span><table id='context85' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/dental_reference_plans.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&quot;#elected_dental_plans&quot;).val(&#39;&lt;%= @plans_ids_json %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template is already cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context86');toggle('message86');toggle('full_message86')" >Html_safe used near line 1: <span class="code">escape_javascript(render(partial =&gt; &quot;plans&quot;, { :locals =&gt; ({ :plans =&gt; (@plans) }) })).html_safe</span><table id='context86' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template is already cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/index.js.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context87');toggle('message87');toggle('full_message87')" >Html_safe used near line 2: <span class="code">escape_javascript(render(partial =&gt; &quot;plan_search_fields&quot;, { :locals =&gt; ({ :search_options =&gt; (@search_options), :search_titles =&gt; (@search_option_titles) }) })).html_safe</span><table id='context87' class='context' style='display:none'><caption>components/sponsored_benefits/app/views/sponsored_benefits/organizations/plan_design_proposals/plans/index.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>$(&#39;.reference-plans&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plans&#39;, locals: { :plans =&gt; @plans })).html_safe %&gt;&quot;)</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.plan-type-filters&#39;).html(&quot;&lt;%= escape_javascript(render(partial: &#39;plan_search_fields&#39;, locals: { search_options: @search_options, search_titles: @search_option_titles })).html_safe %&gt;&quot;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>$(&#39;.reference-plans&#39;).show();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>hideDetailComparisons();</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>clearComparisons();</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Partial update via javascript - the used template is already cleaned.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/ui-components/v1/cards/_metal_level_select.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context88');toggle('message88');toggle('full_message88')" >Html_safe used near line 132: <span class="code">@benefit_package_form.catalog.plan_options.to_json.html_safe</span><table id='context88' class='context' style='display:none'><caption>app/views/ui-components/v1/cards/_metal_level_select.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>127</pre>
          </td>
          <td class='context'>
            <pre class='context'>  var productOptionKind = String;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var selectedRadio = String;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsorContribution = String;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var filteredProducts = String;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var referencePlanID = String;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var planOptions = #{@benefit_package_form.catalog.plan_options.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var applicationStartOn = #{@benefit_package_form.service.benefit_application.effective_period.min.strftime(&quot;%m-%d&quot;).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsorContributions = #{@benefit_package_form.catalog.sponsor_contributions(@benefit_package_form.id).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var minContributions = #{f.object.sponsor_contribution.min_contributions_map.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>	var productsTotal;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/ui-components/v1/cards/_metal_level_select.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context89');toggle('message89');toggle('full_message89')" >Html_safe used near line 133: <span class="code">@benefit_package_form.service.benefit_application.effective_period.min.strftime(&quot;%m-%d&quot;).to_json.html_safe</span><table id='context89' class='context' style='display:none'><caption>app/views/ui-components/v1/cards/_metal_level_select.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>128</pre>
          </td>
          <td class='context'>
            <pre class='context'>  var selectedRadio = String;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsorContribution = String;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var filteredProducts = String;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var referencePlanID = String;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var planOptions = #{@benefit_package_form.catalog.plan_options.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var applicationStartOn = #{@benefit_package_form.service.benefit_application.effective_period.min.strftime(&quot;%m-%d&quot;).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsorContributions = #{@benefit_package_form.catalog.sponsor_contributions(@benefit_package_form.id).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var minContributions = #{f.object.sponsor_contribution.min_contributions_map.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>	var productsTotal;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>  function radioSelected(element) {</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/ui-components/v1/cards/_metal_level_select.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context90');toggle('message90');toggle('full_message90')" >Html_safe used near line 134: <span class="code">@benefit_package_form.catalog.sponsor_contributions(@benefit_package_form.id).to_json.html_safe</span><table id='context90' class='context' style='display:none'><caption>app/views/ui-components/v1/cards/_metal_level_select.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>129</pre>
          </td>
          <td class='context'>
            <pre class='context'>  var sponsorContribution = String;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var filteredProducts = String;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var referencePlanID = String;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var planOptions = #{@benefit_package_form.catalog.plan_options.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var applicationStartOn = #{@benefit_package_form.service.benefit_application.effective_period.min.strftime(&quot;%m-%d&quot;).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsorContributions = #{@benefit_package_form.catalog.sponsor_contributions(@benefit_package_form.id).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var minContributions = #{f.object.sponsor_contribution.min_contributions_map.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>	var productsTotal;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>  function radioSelected(element) {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>139</pre>
            </td>
            <td class='context'>
              <pre class='context'>    setCircle(element)</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/ui-components/v1/cards/_metal_level_select.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context91');toggle('message91');toggle('full_message91')" >Html_safe used near line 135: <span class="code">f.object.sponsor_contribution.min_contributions_map.to_json.html_safe</span><table id='context91' class='context' style='display:none'><caption>app/views/ui-components/v1/cards/_metal_level_select.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>130</pre>
          </td>
          <td class='context'>
            <pre class='context'>  var filteredProducts = String;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var referencePlanID = String;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var planOptions = #{@benefit_package_form.catalog.plan_options.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var applicationStartOn = #{@benefit_package_form.service.benefit_application.effective_period.min.strftime(&quot;%m-%d&quot;).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var sponsorContributions = #{@benefit_package_form.catalog.sponsor_contributions(@benefit_package_form.id).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>  var minContributions = #{f.object.sponsor_contribution.min_contributions_map.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>	var productsTotal;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>138</pre>
            </td>
            <td class='context'>
              <pre class='context'>  function radioSelected(element) {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>139</pre>
            </td>
            <td class='context'>
              <pre class='context'>    setCircle(element)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>140</pre>
            </td>
            <td class='context'>
              <pre class='context'>    disableNewPlanYearButton()</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/ui-components/v1/cards/_reference_plan.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context92');toggle('message92');toggle('full_message92')" >Html_safe used near line 47: <span class="code">@benefit_package_form.service.benefit_application.effective_period.min.strftime(&quot;%m-%d&quot;).to_json.html_safe</span><table id='context92' class='context' style='display:none'><caption>app/views/ui-components/v1/cards/_reference_plan.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>42</pre>
          </td>
          <td class='context'>
            <pre class='context'>        br</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>        span#estimatedEEMax= number_to_currency(f.object.employer_estimated_max_monthly_cost)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if show_benefit_application_tile == &quot;true&quot;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  javascript:</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var appStartOn = #{@benefit_package_form.service.benefit_application.effective_period.min.strftime(&quot;%m-%d&quot;).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var minContributions = #{f.object.sponsor_contribution.min_contributions_map.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    function setInputValue(element) {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>      document.getElementById(element.dataset.id).value = element.value;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>      contributionAmounts(element)</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through JSON serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/ui-components/v1/cards/_reference_plan.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context93');toggle('message93');toggle('full_message93')" >Html_safe used near line 48: <span class="code">f.object.sponsor_contribution.min_contributions_map.to_json.html_safe</span><table id='context93' class='context' style='display:none'><caption>app/views/ui-components/v1/cards/_reference_plan.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>43</pre>
          </td>
          <td class='context'>
            <pre class='context'>        span#estimatedEEMax= number_to_currency(f.object.employer_estimated_max_monthly_cost)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>- if show_benefit_application_tile == &quot;true&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  javascript:</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var appStartOn = #{@benefit_package_form.service.benefit_application.effective_period.min.strftime(&quot;%m-%d&quot;).to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>    var minContributions = #{f.object.sponsor_contribution.min_contributions_map.to_json.html_safe};</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    function setInputValue(element) {</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>      document.getElementById(element.dataset.id).value = element.value;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>      contributionAmounts(element)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    }</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Already passed through json serialization.</td>
      </tr>
    
      <tr>
        <td><span class='med-confidence'>Medium</span></td>
        <td>app/views/ui-components/v1/modals/_read_only_modal.html.slim</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/usage_of_html_safe/">Usage of html_safe</a></td>
        <td></td>
        <td><div class='warning_message' onClick="toggle('context94');toggle('message94');toggle('full_message94')" >Html_safe used near line 7: <span class="code">header_icon.html_safe</span><table id='context94' class='context' style='display:none'><caption>app/views/ui-components/v1/modals/_read_only_modal.html.slim</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>2</pre>
          </td>
          <td class='context'>
            <pre class='context'>  .modal-dialog</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>    .modal-content</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>      .modal-header</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>        .vertically-aligned-row</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>          .modal-title</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>            = header_icon.html_safe </pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>            | &amp;nbsp; </pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>            = title</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>          button.close aria-label=&quot;Close&quot; data-dismiss=&quot;modal&quot; type=&quot;button&quot;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>            span aria-hidden=&quot;true&quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>            | &amp;times;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td>Raw html image tag, no user input allowed.</td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>app/views/employers/premium_statements/_show.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
        <td>[79]</td>
        <td><div class='warning_message' onClick="toggle('context37');toggle('message37');toggle('full_message37')" ><span id='message37' style='display:block'>Unescaped parameter value near line 12: ...</span><span id='full_message37' style='display:none'>Unescaped parameter value near line 12: <span class="code">render_datatable(Effective::Datatables::PremiumBillingReportDataTable.new(:id =&gt; <span class="user_input">params.require(:id)</span>, :billing_date =&gt; (@billing_date)), :sDom =&gt; &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-5&#39;&gt; &lt;&#39;col-sm-5&#39;f&gt; &gt;&quot;, :autowidth =&gt; true, :buttons =&gt; ([&quot;csv&quot;, &quot;excel&quot;]), :lengthMenu =&gt; ([[10, 25, 50, -1], [10, 25, 50, &quot;All&quot;]]))</span></span><table id='context37' class='context' style='display:none'><caption>app/views/employers/premium_statements/_show.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>7</pre>
          </td>
          <td class='context'>
            <pre class='context'>  &lt;/div&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;% if @datatable.present? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;%= raw render_datatable(@datatable,{ sDom: &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-5&#39;&gt; &lt;&#39;col-sm-5&#39;f&gt; &gt;&quot; + &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-10&#39;tr&gt;&gt;&quot;+ &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-9&#39;i&gt; &lt;&#39;col-sm-3&#39;l&gt;&gt;&quot;+ &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-10&#39;p&gt;&gt;&quot;, autowidth: true,buttons: [&#39;csv&#39;,&#39;excel&#39;],&quot;lengthMenu&quot;: [[10, 25, 50, -1], [10, 25, 50, &quot;All&quot;]]})  %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;div class=&quot;col-xs-4&quot;&gt;No employees enrolled.&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>&lt;/div&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>app/views/exchanges/hbx_profiles/_view_enrollment_to_update_end_date.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
        <td>[79]</td>
        <td><div class='warning_message' onClick="toggle('context38');toggle('message38');toggle('full_message38')" >Unescaped model attribute near line 22: <span class="code">fetch_duplicate_enrollment_ids(<span class="user_input">Person.find(params[:person_id]).primary_family</span>.hbx_enrollments.where(:aasm_state.in =&gt; ([&quot;coverage_terminated&quot;, &quot;coverage_termination_pending&quot;, &quot;coverage_expired&quot;]))).map(&amp;:to_s)</span><table id='context38' class='context' style='display:none'><caption>app/views/exchanges/hbx_profiles/_view_enrollment_to_update_end_date.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>17</pre>
          </td>
          <td class='context'>
            <pre class='context'>    var TerminateWithEarlierDate = function () {</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>        $(&#39;#termiante_with_earlier_date&#39;).modal(&#39;show&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>        jQuery(&#39;[id^=&quot;terminate_hbx_&quot;]&#39;).each(function($) {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>            if (this.checked) {</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>                var dup_enr_ids = &lt;%= raw @dup_enr_ids %&gt;;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>                var input_id = this.value;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>                var output = dup_enr_ids.includes(input_id);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>                var new_term_date = jQuery(this).closest(&#39;tr&#39;).find(&quot;input[name=new_termination_date]&quot;)[0].value</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>                var enrollment_effective = jQuery(this).closest(&#39;tr&#39;).find(&quot;td#enrollment_effective_on&quot;).html();</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>                if(new_term_date == enrollment_effective &amp;&amp; !output){</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>app/views/general_agencies/profiles/_employers.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
        <td>[79]</td>
        <td><div class='warning_message' onClick="toggle('context39');toggle('message39');toggle('full_message39')" ><span id='message39' style='display:block'>Unescaped parameter value near line 5: ...</span><span id='full_message39' style='display:none'>Unescaped parameter value near line 5: <span class="code">render_datatable(Effective::Datatables::GeneralAgencyDataTable.new(:id =&gt; <span class="user_input">params[:id]</span>), :lengthMenu =&gt; ([[10, 25, 50, -1], [10, 25, 50, &quot;All&quot;]]), :buttons =&gt; ([&quot;copy&quot;, &quot;csv&quot;, &quot;excel&quot;, &quot;print&quot;]))</span></span><table id='context39' class='context' style='display:none'><caption>app/views/general_agencies/profiles/_employers.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;profile-content top-pd&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;div class=&quot;tab-row&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;div class=&quot;tab-content&quot; id=&quot;myTabContent&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;div class=&quot;container&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;%= raw render_datatable(@datatable,&quot;lengthMenu&quot;: [[10, 25, 50, -1], [10, 25, 50, &quot;All&quot;]], buttons: [</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &#39;copy&#39;,&#39;csv&#39;,&#39;excel&#39;,&#39;print&#39;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>        ]) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;/div&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>app/views/general_agencies/profiles/_families.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
        <td>[79]</td>
        <td><div class='warning_message' onClick="toggle('context40');toggle('message40');toggle('full_message40')" ><span id='message40' style='display:block'>Unescaped parameter value near line 6: ...</span><span id='full_message40' style='display:none'>Unescaped parameter value near line 6: <span class="code">render_datatable(Effective::Datatables::GeneralAgencyFamilyDataTable.new(:id =&gt; <span class="user_input">params[:id]</span>), :lengthMenu =&gt; ([[10, 25, 50], [10, 25, 50]]), :buttons =&gt; ([&quot;copy&quot;, &quot;csv&quot;, &quot;excel&quot;, &quot;print&quot;]))</span></span><table id='context40' class='context' style='display:none'><caption>app/views/general_agencies/profiles/_families.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>&lt;div class=&quot;profile-content top-pd&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &lt;div class=&quot;tab-row&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>    &lt;div class=&quot;tab-content&quot; id=&quot;myTabContent&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;div class=&quot;container&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;div id=&quot;families&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;%= raw render_datatable(@datatable,&quot;lengthMenu&quot;: [[10, 25, 50], [10, 25, 50]], buttons: [</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &#39;copy&#39;,&#39;csv&#39;,&#39;excel&#39;,&#39;print&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>        ]) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;/div&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>app/views/insured/group_selection/edit_plan.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
        <td>[79]</td>
        <td><div class='warning_message' onClick="toggle('context41');toggle('message41');toggle('full_message41')" >Unescaped parameter value near line 33: <span class="code">::Insured::Forms::SelfTermOrCancelForm.for_view(:enrollment_id =&gt; <span class="user_input">params.require(:hbx_enrollment_id)</span>, :family_id =&gt; params.require(:family_id)).product[:display_carrier_logo]</span><table id='context41' class='context' style='display:none'><caption>app/views/insured/group_selection/edit_plan.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>28</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;hr&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;div class=&quot;panel-body&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;div class=&quot;row&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;div class=&quot;col-xs-8&quot;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;div&gt;&lt;%= raw product[:display_carrier_logo] %&gt;&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;h4&gt;&lt;strong&gt;&lt;%= link_to product[:title], summary_products_plans_path({:standard_component_id =&gt; product.hios_id, hbx_enrollment_id: hbx_enrollment[:id], active_year: product.active_year}), remote: true %&gt;&lt;/strong&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;/h4&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  &lt;p&gt;&lt;%= raw render_product_type_details(product[:metal_level_kind], product[:nationwide]) %&gt;&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;/div&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>app/views/insured/group_selection/edit_plan.html.erb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
        <td>[79]</td>
        <td><div class='warning_message' onClick="toggle('context42');toggle('message42');toggle('full_message42')" ><span id='message42' style='display:block'>Unescaped parameter value near line 37: ...</span><span id='full_message42' style='display:none'>Unescaped parameter value near line 37: <span class="code">render_product_type_details(::Insured::Forms::SelfTermOrCancelForm.for_view(:enrollment_id =&gt; <span class="user_input">params.require(:hbx_enrollment_id)</span>, :family_id =&gt; params.require(:family_id)).product[:metal_level_kind], ::Insured::Forms::SelfTermOrCancelForm.for_view(:enrollment_id =&gt; <span class="user_input">params.require(:hbx_enrollment_id)</span>, :family_id =&gt; params.require(:family_id)).product[:nationwide])</span></span><table id='context42' class='context' style='display:none'><caption>app/views/insured/group_selection/edit_plan.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>              &lt;div class=&quot;col-xs-8&quot;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;div&gt;&lt;%= raw product[:display_carrier_logo] %&gt;&lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;h4&gt;&lt;strong&gt;&lt;%= link_to product[:title], summary_products_plans_path({:standard_component_id =&gt; product.hios_id, hbx_enrollment_id: hbx_enrollment[:id], active_year: product.active_year}), remote: true %&gt;&lt;/strong&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;/h4&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  &lt;p&gt;&lt;%= raw render_product_type_details(product[:metal_level_kind], product[:nationwide]) %&gt;&lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>                &lt;div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  &lt;p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>                    &lt;label&gt;&lt;%= l10n(&quot;premium_you_pay&quot;) %&gt;:&lt;/label&gt; &lt;strong&gt;&lt;%= number_to_currency(@self_term_or_cancel_form.enrollment.current_premium, precision:2) %&gt;&lt;/strong&gt;/&lt;%= l10n(&quot;month&quot;).to_s.downcase %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>                    &lt;label class=&quot;bullet-separator&quot;&gt;&amp;nbsp;ID:&lt;/label&gt; &lt;strong&gt;&lt;%= hbx_enrollment[:hbx_id] %&gt;&lt;/strong&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/models/effective/active_record_datatable_tool.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
        <td>[89]</td>
        <td><div class='warning_message' onClick="toggle('context25');toggle('message25');toggle('full_message25')" ><span id='message25' style='display:block'>Possible SQL injection near line 45: ...</span><span id='full_message25' style='display:none'>Possible SQL injection near line 45: <span class="code">collection.order(&quot;#{(&quot;&quot; or &quot;ISNULL(#{<span class="user_input">sql_column</span>}), &quot;)}#{<span class="user_input">sql_column</span>.sub(&quot;_id&quot;, &quot;_type&quot;)} #{(&quot;DESC&quot; or &quot;ASC&quot;)}, #{<span class="user_input">sql_column</span>} #{(&quot;DESC&quot; or &quot;ASC&quot;)}#{(&quot;&quot; or (&quot; NULLS FIRST&quot; or if (table_column[:nulls] == :last) then   &quot; NULLS LAST&quot; else   &quot; NULLS #{(direction == :desc) ? (&quot;FIRST&quot;) : (&quot;LAST&quot;)}&quot; end))}&quot;)</span></span><table id='context25' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/models/effective/active_record_datatable_tool.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>40</pre>
          </td>
          <td class='context'>
            <pre class='context'>      elsif mysql?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        before = &quot;ISNULL(#{sql_column}), &quot;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if table_column[:type] == :belongs_to_polymorphic</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{before}#{sql_column.sub(&#39;_id&#39;, &#39;_type&#39;)} #{sql_direction}, #{sql_column} #{sql_direction}#{after}&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      elsif table_column[:sql_as_column] == true</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{sql_column} #{sql_direction}&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{before}#{sql_column} #{sql_direction}#{after}&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/models/effective/active_record_datatable_tool.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
        <td>[89]</td>
        <td><div class='warning_message' onClick="toggle('context26');toggle('message26');toggle('full_message26')" >Possible SQL injection near line 47: <span class="code">collection.order(&quot;#{<span class="user_input">sql_column</span>} #{(&quot;DESC&quot; or &quot;ASC&quot;)}&quot;)</span><table id='context26' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/models/effective/active_record_datatable_tool.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>42</pre>
          </td>
          <td class='context'>
            <pre class='context'>      end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if table_column[:type] == :belongs_to_polymorphic</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{before}#{sql_column.sub(&#39;_id&#39;, &#39;_type&#39;)} #{sql_direction}, #{sql_column} #{sql_direction}#{after}&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      elsif table_column[:sql_as_column] == true</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{sql_column} #{sql_direction}&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{before}#{sql_column} #{sql_direction}#{after}&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/models/effective/active_record_datatable_tool.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
        <td>[89]</td>
        <td><div class='warning_message' onClick="toggle('context27');toggle('message27');toggle('full_message27')" ><span id='message27' style='display:block'>Possible SQL injection near line 49: ...</span><span id='full_message27' style='display:none'>Possible SQL injection near line 49: <span class="code">collection.order(&quot;#{(&quot;&quot; or &quot;ISNULL(#{<span class="user_input">sql_column</span>}), &quot;)}#{<span class="user_input">sql_column</span>} #{(&quot;DESC&quot; or &quot;ASC&quot;)}#{(&quot;&quot; or (&quot; NULLS FIRST&quot; or if (table_column[:nulls] == :last) then   &quot; NULLS LAST&quot; else   &quot; NULLS #{(direction == :desc) ? (&quot;FIRST&quot;) : (&quot;LAST&quot;)}&quot; end))}&quot;)</span></span><table id='context27' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/models/effective/active_record_datatable_tool.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>44</pre>
          </td>
          <td class='context'>
            <pre class='context'>      if table_column[:type] == :belongs_to_polymorphic</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{before}#{sql_column.sub(&#39;_id&#39;, &#39;_type&#39;)} #{sql_direction}, #{sql_column} #{sql_direction}#{after}&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>      elsif table_column[:sql_as_column] == true</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>47</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{sql_column} #{sql_direction}&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.order(&quot;#{before}#{sql_column} #{sql_direction}#{after}&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    def search(collection)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>      search_terms.each do |name, search_term|</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
      <tr>
        <td><span class='weak-confidence'>Weak</span></td>
        <td>project_gems/effective_datatables-2.6.14/app/models/effective/active_record_datatable_tool.rb</td>
        <td><a rel="noreferrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
        <td>[89]</td>
        <td><div class='warning_message' onClick="toggle('context28');toggle('message28');toggle('full_message28')" ><span id='message28' style='display:block'>Possible SQL injection near line 173: ...</span><span id='full_message28' style='display:none'>Possible SQL injection near line 173: <span class="code">Effective::Address.where(&quot;addressable_type = ?&quot;, collection_class.name).where(&quot;address1 #{<span class="user_input">ilike</span>} :term OR address2 #{<span class="user_input">ilike</span>} :term OR city #{<span class="user_input">ilike</span>} :term OR postal_code #{<span class="user_input">ilike</span>} :term OR state_code = :code OR country_code = :code&quot;, :term =&gt; (&quot;%#{term}%&quot;), :code =&gt; term)</span></span><table id='context28' class='context' style='display:none'><caption>project_gems/effective_datatables-2.6.14/app/models/effective/active_record_datatable_tool.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>168</pre>
          </td>
          <td class='context'>
            <pre class='context'>          collection.public_send(sql_op, &quot;#{sql_column} = :term&quot;, term: deobfuscated_id)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>169</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>      when :effective_address</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>171</pre>
            </td>
            <td class='context'>
              <pre class='context'>        ids = Effective::Address</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>          .where(&#39;addressable_type = ?&#39;, collection_class.name)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>173</pre>
            </td>
            <td class='context'>
              <pre class='context'>          .where(&quot;address1 #{ilike} :term OR address2 #{ilike} :term OR city #{ilike} :term OR postal_code #{ilike} :term OR state_code = :code OR country_code = :code&quot;, term: &quot;%#{term}%&quot;, code: term)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>174</pre>
            </td>
            <td class='context'>
              <pre class='context'>          .pluck(:addressable_id)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>176</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.public_send(sql_op, id: ids)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>177</pre>
            </td>
            <td class='context'>
              <pre class='context'>      when :effective_roles</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>178</pre>
            </td>
            <td class='context'>
              <pre class='context'>        collection.with_role(term)</pre>
            </td>
          </tr>
</tbody></table></div></td>
        <td></td>
      </tr>
    
    </tbody>
  </table>
</div>
</body></html>